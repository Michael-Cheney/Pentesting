# Network
## WireShark
### Filters
| Info | Command |
|:-----|:--------|
| Source IP Address | `ip.src == 192.168.1.1` |
| Destination IP Address | `ip.dst == 192.168.1.1` |
| TCP Port | `tcp.port == 22` |
| UDP Port | `udp.port == 67` |
| HTTP GET Request | `http.request.method == GET` |
| HTTP POST Request | `http.request.method == POST` |
| Source & Destination Addresses | `ip.src==192.168.0.0/16 and ip.dst==192.168.0.0/16` | 


### Comparison Operators
| Info | Command |
|:-----|:--------|
| Equal | `ip.src == 10.10.10.100` |
| Not equal | `ip.src != 10.10.10.100` |
| Greater than | `ip.ttl > 250` |
| Less than | `ip.ttl < 10` |
| Greater than or equal to | `ip.ttl >= 0xFA` |
| Less than or equal to | `ip.ttl <= 0xA` |

### Logical Expressions
| Info | Command |
|:-----|:--------|
| Logical AND | `(ip.src == 10.10.10.100) AND (ip.src == 10.10.10.111)` |
| Logical OR | `(ip.src == 10.10.10.100) OR (ip.src == 10.10.10.111)` |
| Logical NOT | `!(ip.src == 10.10.10.222)` |

### IP Filters
| Info | Command |
|:-----|:--------|
| Show all IP packets | `ip` |
| Show all packets containing IP addresses from 10.10.10.0/24 subnet. | `ip.addr == 10.10.10.0/24` |
| Show all packets originated from 10.10.10.111 | `ip.src == 10.10.10.111` |
| Show all packets sent to 10.10.10.111| `ip.dst == 10.10.10.111` |

**The ip.addr filters the traffic without considering the packet direction. The ip.src/ip.dst filters the packet depending on the packet direction.**

### TCP and UDP Filters
| Info | Command |
|:-----|:--------|
| Show all TCP packets with port 80 | `tcp.port == 80` |
| Show all TCP packets originating from port 1234 | `tcp.srcport == 1234` |
| Show all TCP packets sent to port 80 | `tcp.dstport == 80` |
| Show all UDP packets with port 53 | `udp.port == 53` |
| Show all UDP packets originating from port 1234 | `udp.srcport == 1234` |
| Show all UDP packets sent to port 535 | `udp.dstport == 5353` |

### Application Level Protocol Filters | HTTP and DNS
| Info | Command |
|:-----|:--------|
| Show all HTTP packets | `http` |
| Show all packets with HTTP response code "200" | `http.response.code == 200` |
| Show all HTTP GET requests | `http.request.method == "GET"` |
| Show all HTTP POST requests | `http.request.method == "POST"` |
| Show all DNS packets | `dns` |
| Show all DNS requests | `dns.flags.response == 0` |
| Show all DNS responses | `dns.flags.response == 1` |
| Show all DNS "A" records | `dns.qry.type == 1` | 

### Advanced Filtering
| Info | Command |
|:-----|:--------|
| Contains (List all HTTP packets where packets' "server" field contains the "Apache" keyword.) | `http.server contains "Apache"` | 
| Matches (List all HTTP packets where packets' "host" fields match keywords ".php" or ".html".) | `http.host matches "\.(php || html)"` |
| In (List all TCP packets where packets' "port" fields have values 80, 443 or 8080.) | `tcp.port in {80 443 8080}` |
| Upper (Convert all HTTP packets' "server" fields to uppercase and list packets that contain the "APACHE" keyword.) | `upper(http.server) contains "APACHE"` |
| Lower (Convert all HTTP packets' "server" fields info to lowercase and list packets that contain the "apache" keyword.) | `lower(http.server) contains "apache"` | 
| String (Convert all "frame number" fields to string values, and list frames end with odd values.) | `string(frame.number) matches "[13579]$"` |

