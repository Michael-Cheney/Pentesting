# Packet Sniffing with Scapy
* Raw sockets are painful to use and not too portable across Oss
* Use of 3rd Party Libraryies:s
  * pylibpcap
  * pycapy
  * pypcap
  * Impacket
  * Scapy
* We will use Scapy in this course because it's the most powerful and flexible amon all other options

## Scapy
* Interactive mode or use a library
* Can be used for packet sniffing and forging
* Tons of protocols already implemented
* Allows to build "reactive" tools
* Uses Berkely Packet Filter syntax by default

## Examples
```python
# Start scapy interactive mode
sudo scapy
# List all the protocols that Scapy supports
ls()
# Look at configuration options
conf
# List commands
lsc
# Sniffing 3 packets on eth1
pkts = sniff(iface="eth1", count=3)
# Display individual packet
pkts[0]
# Display with better formating
pkts[0].show()
# Dump the packet in hex
hexdump(pktsp[0])
# Simulating sniffing with an offline pcap file
pkts = sniff(offline"offline.pcap")
# Adding filters
pkts = sniff(iface="eth1", filter="arp", count=3)
# Print packets live
pkts = sniff(iface="eth1", filter="imcp", count=20, prnt=labda x: x.summary())
# Write packets to a pcap file 
wrcap("demo.cap", pkts)
# Read from a pcap file
rdpcap("demo.cap")
# Export packet as base64 encoded
export_object(str(pkts[0]))
# Import packet from base64 encoded
newPkt = import_object()
# Export packet as string
str(pkts[0])
# Import packets from a string
FirstHeader e.g. Ether(pkt_string)
```